"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/[...nextapi]";
exports.ids = ["pages/api/[...nextapi]"];
exports.modules = {

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\[...nextapi].js */ \"(api)/./src/pages/api/[...nextapi].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/[...nextapi]\",\n        pathname: \"/api/[...nextapi]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRiU1Qi4uLm5leHRhcGklNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1QyU1Qi4uLm5leHRhcGklNUQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDK0Q7QUFDL0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbnBhbmVsLz85NTJmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmNcXFxccGFnZXNcXFxcYXBpXFxcXFsuLi5uZXh0YXBpXS5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL1suLi5uZXh0YXBpXVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL1suLi5uZXh0YXBpXVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/[...nextapi].js":
/*!***************************************!*\
  !*** ./src/pages/api/[...nextapi].js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler),\n/* harmony export */   handleUpdateAdminData: () => (/* binding */ handleUpdateAdminData)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/db */ \"(api)/./src/utils/db.js\");\n\n\n\n\nconst db = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: process.env.MYSQL_PORT,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    database: process.env.MYSQL_DATABASE,\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0\n});\nasync function handler(req, res) {\n    const { method } = req;\n    const { pathname, query } = (0,url__WEBPACK_IMPORTED_MODULE_1__.parse)(req.url, true);\n    console.log(\"Received request:\", method, pathname, query);\n    if (pathname === \"/api/test\") {\n        res.status(200).json({\n            message: \"Test route working\"\n        });\n        return;\n    }\n    if (pathname === \"/api/admin-name\") {\n        try {\n            const [results] = await db.query(\"SELECT full_name FROM admin LIMIT 1\");\n            if (results.length > 0) {\n                res.status(200).json({\n                    fullName: results[0].full_name\n                });\n            } else {\n                res.status(404).json({\n                    error: \"Admin not found\"\n                });\n            }\n        } catch (error) {\n            console.error(\"Error fetching admin name:\", error);\n            res.status(500).json({\n                error: \"An error occurred while fetching admin name\"\n            });\n        }\n        return;\n    }\n    try {\n        switch(method){\n            case \"GET\":\n                if (pathname === \"/api/check-auth\") {\n                    const authHeader = req.headers.authorization;\n                    if (!authHeader) {\n                        return res.status(200).json({\n                            isAuthenticated: false,\n                            usernamePasswordVerified: false\n                        });\n                    }\n                    const token = authHeader.split(\" \")[1];\n                    try {\n                        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n                        const now = Math.floor(Date.now() / 1000);\n                        if (decoded.exp && decoded.exp > now) {\n                            // Token is still valid\n                            return res.status(200).json({\n                                isAuthenticated: true,\n                                usernamePasswordVerified: true,\n                                expiresIn: decoded.exp - now\n                            });\n                        } else {\n                            // Token has expired\n                            return res.status(200).json({\n                                isAuthenticated: false,\n                                usernamePasswordVerified: false\n                            });\n                        }\n                    } catch (error) {\n                        return res.status(200).json({\n                            isAuthenticated: false,\n                            usernamePasswordVerified: false\n                        });\n                    }\n                } else if (pathname === \"/api/products\") {\n                    await handleGetProducts(req, res);\n                } else if (pathname === \"/api/stocks\") {\n                    await handleGetStocks(req, res);\n                } else if (pathname === \"/api/total-stock\") {\n                    await handleGetTotalStock(req, res);\n                } else if (pathname === \"/api/sales-report\") {\n                    await handleGetSalesReport(req, res);\n                } else if (pathname === \"/api/sales-data\") {\n                    await handleGetSalesData(req, res);\n                } else if (pathname === \"/api/total-products\") {\n                    await handleGetTotalProducts(req, res);\n                } else if (pathname === \"/api/top-products\") {\n                    await handleGetTopProducts(req, res);\n                } else if (pathname === \"/api/rated-products-count\") {\n                    await handleGetRatedProductsCount(req, res);\n                } else if (pathname === \"/api/logout\") {\n                    await handleLogout(req, res);\n                    return;\n                } else if (pathname === \"/api/orders\") {\n                    await handleGetOrders(req, res);\n                } else if (pathname === \"/api/admin-data\") {\n                    await handleGetAdminData(req, res);\n                } else if (pathname === \"/api/session-history\") {\n                    await handleGetSessionHistory(req, res);\n                } else if (pathname === \"/api/product-analytics\") {\n                    await handleGetProductAnalytics(req, res);\n                } else if (pathname === \"/api/product-performance\") {\n                    await handleGetProductPerformance(req, res);\n                } else if (pathname === \"/api/daily-sales\") {\n                    await handleGetDailySales(req, res);\n                } else if (pathname === \"/api/weekly-sales\") {\n                    await handleGetWeeklySales(req, res);\n                } else if (pathname === \"/api/monthly-sales\") {\n                    await handleGetMonthlySales(req, res);\n                } else if (pathname === \"/api/yearly-sales\") {\n                    await handleGetYearlySales(req, res);\n                } else if (pathname === \"/api/order-details\") {\n                    await handleGetOrderDetails(req, res);\n                }\n                break;\n            case \"POST\":\n                if (pathname === \"/api/signin\") {\n                    await handleSignIn(req, res);\n                } else if (pathname === \"/api/validate-pin\") {\n                    await handleValidatePin(req, res);\n                } else if (pathname === \"/api/products\") {\n                    await handleAddProduct(req, res);\n                } else if (pathname === \"/api/stocks\") {\n                    await handleAddStock(req, res);\n                }\n                break;\n            case \"PUT\":\n                if (pathname.startsWith(\"/api/products/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleUpdateProduct(req, res, id);\n                } else if (pathname.startsWith(\"/api/stocks/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleUpdateStock(req, res, id);\n                } else if (pathname.startsWith(\"/api/orders/\")) {\n                    const parts = pathname.split(\"/\");\n                    const id = parts[3]; // This is the order ID\n                    if (parts[4] === \"status\") {\n                        await handleUpdateOrderStatus(req, res, id);\n                    } else if (parts[4] === \"cancel\") {\n                        await handleCancelOrder(req, res, id);\n                    } else {\n                        await handleUpdateOrder(req, res, id);\n                    }\n                }\n                if (pathname === \"/api/update-admin\") {\n                    await handleUpdateAdminData(req, res);\n                }\n                break;\n            case \"DELETE\":\n                if (pathname.startsWith(\"/api/products/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleDeleteProduct(req, res, id);\n                } else if (pathname.startsWith(\"/api/stocks/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleDeleteStock(req, res, id);\n                } else if (pathname.startsWith(\"/api/orders/\") && pathname.endsWith(\"/salesreport\")) {\n                    await handleRemoveOrderFromSalesReport(req, res);\n                } else {\n                    res.status(404).json({\n                        error: \"Route not found\"\n                    });\n                }\n                break;\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\",\n                    \"PUT\",\n                    \"DELETE\"\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n        res.status(404).json({\n            error: \"Route not found\"\n        });\n    } catch (error) {\n        console.error(\"Error in API route:\", error);\n        res.status(500).json({\n            error: \"An error occurred while processing your request\"\n        });\n    }\n}\n//Sales Report \nasync function handleGetOrderDetails(req, res) {\n    const { date } = req.query;\n    let dateCondition;\n    if (!date) {\n        dateCondition = \"DATE(o.order_date) = CURDATE()\";\n    } else {\n        const queryDate = new Date(date);\n        dateCondition = `DATE(o.order_date) = DATE('${queryDate.toISOString().split(\"T\")[0]}')`;\n    }\n    try {\n        const [results] = await db.query(`\r\n      SELECT \r\n        o.order_date,\r\n        o.full_name,\r\n        op.name as product_name,\r\n        op.quantity,\r\n        o.total,\r\n        p.image_url\r\n      FROM orders o\r\n      JOIN ordered_products op ON o.id = op.order_id\r\n      JOIN products p ON op.product_id = p.id\r\n      WHERE \r\n        ${dateCondition}\r\n        AND o.status = 'Delivered'\r\n        AND o.in_sales_report = 1\r\n      ORDER BY o.order_date DESC\r\n    `);\n        res.status(200).json(results);\n    } catch (error) {\n        console.error(\"Error fetching order details:\", error);\n        res.status(500).json({\n            error: \"Error fetching order details\"\n        });\n    }\n}\nasync function handleGetMonthlySales(req, res) {\n    const { year } = req.query;\n    const currentYear = year || new Date().getFullYear();\n    try {\n        const [results] = await db.query(`\r\n      SELECT \r\n        MONTH(order_date) as month,\r\n        SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN 1 ELSE 0 END) as orderCount,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as total,\r\n        SUM(CASE WHEN status = 'Cancelled' THEN 1 ELSE 0 END) as cancelledCount,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Cancelled' THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as cancelledTotal\r\n      FROM orders\r\n      WHERE YEAR(order_date) = ?\r\n      GROUP BY MONTH(order_date)\r\n      ORDER BY month\r\n    `, [\n            currentYear\n        ]);\n        const formattedResults = results.map((row)=>({\n                month: row.month,\n                orderCount: Number(row.orderCount),\n                total: Number(row.total),\n                cancelledCount: Number(row.cancelledCount),\n                cancelledTotal: Number(row.cancelledTotal)\n            }));\n        res.status(200).json(formattedResults);\n    } catch (error) {\n        console.error(\"Error fetching monthly sales:\", error);\n        res.status(500).json({\n            error: \"Error fetching monthly sales data\"\n        });\n    }\n}\nasync function handleGetDailySales(req, res) {\n    try {\n        const [results] = await db.query(`\r\n      SELECT \r\n        DAYOFWEEK(order_date) as period,\r\n        SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN 1 ELSE 0 END) as orders,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as total,\r\n        SUM(CASE WHEN status = 'Cancelled' THEN 1 ELSE 0 END) as cancelledOrders,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Cancelled' THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as cancelledTotal\r\n      FROM orders\r\n      WHERE YEARWEEK(order_date) = YEARWEEK(CURDATE())\r\n      GROUP BY DAYOFWEEK(order_date)\r\n      ORDER BY period\r\n    `);\n        const daysOfWeek = [\n            \"Sunday\",\n            \"Monday\",\n            \"Tuesday\",\n            \"Wednesday\",\n            \"Thursday\",\n            \"Friday\",\n            \"Saturday\"\n        ];\n        const fullWeekData = Array.from({\n            length: 7\n        }, (_, i)=>({\n                period: daysOfWeek[i],\n                orders: 0,\n                total: 0,\n                cancelledOrders: 0,\n                cancelledTotal: 0\n            }));\n        results.forEach((row)=>{\n            const dayIndex = row.period - 1;\n            fullWeekData[dayIndex] = {\n                period: daysOfWeek[dayIndex],\n                orders: Number(row.orders),\n                total: Number(row.total),\n                cancelledOrders: Number(row.cancelledOrders),\n                cancelledTotal: Number(row.cancelledTotal)\n            };\n        });\n        res.status(200).json(fullWeekData);\n    } catch (error) {\n        console.error(\"Error fetching daily sales:\", error);\n        res.status(500).json({\n            error: \"Error fetching daily sales data\"\n        });\n    }\n}\nasync function handleGetWeeklySales(req, res) {\n    try {\n        const [results] = await db.query(`\r\n      SELECT \r\n        WEEK(order_date) as weekNumber,\r\n        MIN(DATE(order_date)) as weekStart,\r\n        MAX(DATE(order_date)) as weekEnd,\r\n        SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN 1 ELSE 0 END) as orders,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as total,\r\n        SUM(CASE WHEN status = 'Cancelled' THEN 1 ELSE 0 END) as cancelledOrders,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Cancelled' THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as cancelledTotal\r\n      FROM orders\r\n      WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 7 WEEK)\r\n      GROUP BY WEEK(order_date)\r\n      ORDER BY weekNumber\r\n    `);\n        const formattedResults = results.map((row)=>({\n                period: `Week ${row.weekNumber} (${new Date(row.weekStart).toLocaleDateString()} - ${new Date(row.weekEnd).toLocaleDateString()})`,\n                orders: Number(row.orders),\n                total: Number(row.total),\n                cancelledOrders: Number(row.cancelledOrders),\n                cancelledTotal: Number(row.cancelledTotal)\n            }));\n        res.status(200).json(formattedResults);\n    } catch (error) {\n        console.error(\"Error fetching weekly sales:\", error);\n        res.status(500).json({\n            error: \"Error fetching weekly sales data\"\n        });\n    }\n}\nasync function handleGetYearlySales(req, res) {\n    try {\n        const currentYear = new Date().getFullYear();\n        const [results] = await db.query(`\r\n      SELECT \r\n        YEAR(order_date) as period,\r\n        SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN 1 ELSE 0 END) as orders,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Delivered' AND in_sales_report = 1 THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as total,\r\n        SUM(CASE WHEN status = 'Cancelled' THEN 1 ELSE 0 END) as cancelledOrders,\r\n        CAST(COALESCE(SUM(CASE WHEN status = 'Cancelled' THEN total ELSE 0 END), 0) AS DECIMAL(10,2)) as cancelledTotal\r\n      FROM orders\r\n      WHERE YEAR(order_date) >= ?\r\n      GROUP BY YEAR(order_date)\r\n      ORDER BY period\r\n    `, [\n            currentYear - 4\n        ]);\n        const yearlyData = Array.from({\n            length: 5\n        }, (_, index)=>{\n            const year = currentYear - 4 + index;\n            return {\n                period: year.toString(),\n                orders: 0,\n                total: 0,\n                cancelledOrders: 0,\n                cancelledTotal: 0\n            };\n        });\n        results.forEach((row)=>{\n            const yearIndex = row.period - (currentYear - 4);\n            if (yearIndex >= 0 && yearIndex < 5) {\n                yearlyData[yearIndex] = {\n                    period: row.period.toString(),\n                    orders: Number(row.orders),\n                    total: Number(row.total),\n                    cancelledOrders: Number(row.cancelledOrders),\n                    cancelledTotal: Number(row.cancelledTotal)\n                };\n            }\n        });\n        res.status(200).json(yearlyData);\n    } catch (error) {\n        console.error(\"Error fetching yearly sales:\", error);\n        res.status(500).json({\n            error: \"Error fetching yearly sales data\"\n        });\n    }\n}\nasync function handleGetSalesData(req, res) {\n    const { date } = req.query;\n    let dateCondition;\n    if (!date) {\n        dateCondition = \"DATE(order_date) = CURDATE()\";\n    } else {\n        const queryDate = new Date(date);\n        dateCondition = `DATE(order_date) = DATE('${queryDate.toISOString().split(\"T\")[0]}')`;\n    }\n    try {\n        const [salesResult] = await db.query(`\r\n      SELECT COALESCE(SUM(total), 0) as periodSales\r\n      FROM orders\r\n      WHERE ${dateCondition} AND status = 'Delivered'\r\n    `);\n        const [ordersResult] = await db.query(`\r\n      SELECT COUNT(*) as totalOrders\r\n      FROM orders\r\n      WHERE ${dateCondition}\r\n    `);\n        const [customersResult] = await db.query(`\r\n      SELECT COUNT(DISTINCT user_id) as totalCustomers\r\n      FROM orders\r\n      WHERE ${dateCondition}\r\n    `);\n        const result = {\n            periodSales: Number(salesResult[0].periodSales),\n            totalOrders: ordersResult[0].totalOrders,\n            totalCustomers: customersResult[0].totalCustomers\n        };\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching sales data:\", error);\n        res.status(500).json({\n            error: \"Error fetching sales data\"\n        });\n    }\n}\nasync function handleGetTopProducts(req, res) {\n    const [result] = await db.query(`\r\n    SELECT \r\n      p.id,\r\n      p.name,\r\n      p.image_url,\r\n      COALESCE(AVG(pr.rating), 0) as avg_rating,\r\n      COALESCE(SUM(op.quantity), 0) as sold\r\n    FROM products p\r\n    LEFT JOIN ordered_products op ON p.id = op.product_id\r\n    LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n    GROUP BY p.id\r\n    ORDER BY sold DESC, avg_rating DESC\r\n    LIMIT 5\r\n  `);\n    const formattedResult = result.map((product)=>({\n            ...product,\n            avg_rating: Number(product.avg_rating).toFixed(1)\n        }));\n    res.status(200).json(formattedResult);\n}\nasync function handleGetRatedProductsCount(req, res) {\n    const { timeFrame } = req.query;\n    let dateCondition;\n    switch(timeFrame){\n        case \"today\":\n            dateCondition = \"DATE(created_at) = CURDATE()\";\n            break;\n        case \"yesterday\":\n            dateCondition = \"DATE(created_at) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\";\n            break;\n        case \"lastWeek\":\n            dateCondition = \"DATE(created_at) BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 WEEK) AND CURDATE()\";\n            break;\n        case \"lastMonth\":\n            dateCondition = \"DATE(created_at) BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE()\";\n            break;\n        default:\n            dateCondition = \"DATE(created_at) = CURDATE()\";\n    }\n    const [result] = await db.query(`\r\n    SELECT COUNT(DISTINCT product_id) as ratedProductsCount\r\n    FROM product_ratings\r\n    WHERE ${dateCondition}\r\n  `);\n    res.status(200).json(result[0]);\n}\nasync function handleGetTotalProducts(req, res) {\n    const [result] = await db.query(\"SELECT COUNT(*) as totalProducts FROM products\");\n    res.status(200).json(result[0]);\n}\nasync function handleGetProductAnalytics(req, res) {\n    try {\n        // Get products with their ratings, orders, and stock information\n        const [products] = await db.query(`\r\n      SELECT \r\n        p.*,\r\n        COALESCE(ps.quantity, 0) as stock_quantity,\r\n        COALESCE(AVG(pr.rating), 0) as avg_rating,\r\n        COUNT(DISTINCT o.id) as order_count\r\n      FROM products p\r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      LEFT JOIN ordered_products op ON p.id = op.product_id\r\n      LEFT JOIN orders o ON op.order_id = o.id\r\n      WHERE p.deleted = FALSE\r\n      GROUP BY p.id\r\n    `);\n        // Calculate saleable metrics\n        const analyzedProducts = products.map((product)=>({\n                ...product,\n                isSaleable: product.order_count > 0 && product.avg_rating >= 3.5 && product.stock_quantity > 0\n            }));\n        const saleableProducts = analyzedProducts.filter((p)=>p.isSaleable);\n        const nonSaleableProducts = analyzedProducts.filter((p)=>!p.isSaleable);\n        res.status(200).json({\n            saleableProducts,\n            nonSaleableProducts,\n            totalProducts: products.length,\n            saleableCount: saleableProducts.length,\n            nonSaleableCount: nonSaleableProducts.length\n        });\n    } catch (error) {\n        console.error(\"Error fetching product analytics:\", error);\n        res.status(500).json({\n            error: \"Error fetching product analytics\"\n        });\n    }\n}\nasync function handleGetProductPerformance(req, res) {\n    try {\n        // Modified query to include description and other relevant fields\n        const [performanceData] = await db.query(`\r\n      SELECT \r\n        p.id,\r\n        p.name,\r\n        p.description,     \r\n        p.price,\r\n        p.image_url,\r\n        p.category,        \r\n        COUNT(DISTINCT o.id) as total_orders,\r\n        COALESCE(SUM(op.quantity), 0) as total_units_sold,\r\n        COALESCE(AVG(pr.rating), 0) as average_rating,\r\n        COUNT(DISTINCT pr.id) as rating_count,\r\n        ps.quantity as current_stock,\r\n        ps.id as stock_id\r\n      FROM products p\r\n      INNER JOIN ordered_products op ON p.id = op.product_id\r\n      LEFT JOIN orders o ON op.order_id = o.id AND o.status != 'cancelled'\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      WHERE p.deleted = FALSE\r\n      GROUP BY p.id, ps.id, p.description, p.category \r\n      ORDER BY COALESCE(SUM(op.quantity), 0) DESC\r\n    `);\n        // Filter products based on the criteria\n        const saleableProducts = performanceData.filter((product)=>product.total_units_sold > 20);\n        const nonSaleableProducts = performanceData.filter((product)=>product.total_units_sold < 5 && product.total_units_sold > 0);\n        res.status(200).json({\n            performance: performanceData,\n            saleableProducts: saleableProducts.slice(0, 10),\n            nonSaleableProducts: nonSaleableProducts.slice(0, 10)\n        });\n    } catch (error) {\n        console.error(\"Error fetching product performance:\", error);\n        res.status(500).json({\n            error: \"Error fetching product performance\"\n        });\n    }\n}\n//Login Authentication and Logout\nasync function handleSignIn(req, res) {\n    const { username, password } = req.body;\n    console.log(\"Signin attempt:\", {\n        username\n    });\n    try {\n        const [results] = await db.query(\"SELECT * FROM admin WHERE username = ?\", [\n            username\n        ]);\n        if (results.length === 0) {\n            console.log(\"User not found\");\n            return res.status(401).json({\n                error: \"Invalid username or password\"\n            });\n        }\n        const user = results[0];\n        const passwordMatch = password === user.password;\n        if (!passwordMatch) {\n            console.log(\"Password mismatch\");\n            return res.status(401).json({\n                error: \"Invalid username or password\"\n            });\n        }\n        await db.query(\"INSERT INTO admin_sessions (admin_id, login_time) VALUES (?, NOW())\", [\n            user.id\n        ]);\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: user.id\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"6h\"\n        });\n        console.log(\"Login successful, token generated\");\n        res.status(200).json({\n            success: true,\n            message: \"Signin successful\",\n            username: user.username,\n            token: token\n        });\n    } catch (error) {\n        console.error(\"Sign in error:\", error);\n        res.status(500).json({\n            error: \"An error occurred during signin\"\n        });\n    }\n}\nasync function handleValidatePin(req, res) {\n    const { pin } = req.body;\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const [results] = await db.query(\"SELECT pin FROM admin WHERE id = ?\", [\n            decoded.userId\n        ]);\n        if (results.length === 0) {\n            return res.status(404).json({\n                error: \"Admin not found\"\n            });\n        }\n        const storedPin = results[0].pin;\n        if (String(pin) === String(storedPin)) {\n            res.status(200).json({\n                message: \"PIN validated successfully\"\n            });\n        } else {\n            res.status(401).json({\n                error: \"Invalid PIN\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error validating PIN:\", error);\n        res.status(500).json({\n            error: \"An error occurred while validating PIN\"\n        });\n    }\n}\nasync function handleLogout(req, res) {\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (token) {\n        try {\n            const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n            await db.query(`\r\n        UPDATE admin_sessions \r\n        SET logout_time = NOW() \r\n        WHERE admin_id = ? AND logout_time IS NULL \r\n        ORDER BY login_time DESC LIMIT 1\r\n      `, [\n                decoded.userId\n            ]);\n        } catch (error) {\n            console.error(\"Error during logout:\", error);\n        }\n    }\n    res.setHeader(\"Set-Cookie\", \"token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; HttpOnly\");\n    res.status(200).json({\n        success: true,\n        message: \"Logout successful\"\n    });\n}\nasync function handleGetAdminData(req, res) {\n    try {\n        const [results] = await db.query(\"SELECT full_name, username, password, pin, role FROM admin LIMIT 1\");\n        if (results.length > 0) {\n            const adminData = results[0];\n            adminData.password = \"*\".repeat(adminData.password.length);\n            adminData.pin = \"*\".repeat(adminData.pin.length);\n            res.status(200).json(adminData);\n        } else {\n            res.status(404).json({\n                error: \"Admin not found\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error fetching admin data:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching admin data\"\n        });\n    }\n}\nasync function handleUpdateAdminData(req, res) {\n    const { full_name, username, password, pin, role } = req.body;\n    try {\n        let sql = \"UPDATE admin SET full_name = ?, username = ?, role = ?\";\n        let params = [\n            full_name,\n            username,\n            role\n        ];\n        if (password) {\n            sql += \", password = ?\";\n            params.push(password);\n        }\n        if (pin) {\n            sql += \", pin = ?\";\n            params.push(pin);\n        }\n        sql += \" WHERE id = 1\";\n        const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(sql, params);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Admin not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Admin data updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating admin data:\", error);\n        res.status(500).json({\n            error: \"An error occurred while updating admin data\"\n        });\n    }\n}\nasync function handleGetSessionHistory(req, res) {\n    try {\n        const [results] = await db.query(`\r\n      SELECT \r\n        s.id, \r\n        a.full_name, \r\n        a.username, \r\n        s.login_time, \r\n        s.logout_time\r\n      FROM \r\n        admin_sessions s\r\n      JOIN \r\n        admin a ON s.admin_id = a.id\r\n      ORDER BY \r\n        s.login_time DESC \r\n      LIMIT 50\r\n    `);\n        res.status(200).json(results);\n    } catch (error) {\n        console.error(\"Error fetching session history:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching session history\"\n        });\n    }\n}\n//Products\nasync function handleGetProducts(req, res) {\n    const { page = 1, limit = 10, id, category } = req.query;\n    const offset = (page - 1) * limit;\n    try {\n        // Single product fetch\n        if (id) {\n            const [products] = await db.query(`\r\n        SELECT \r\n          p.*,\r\n          COALESCE(ps.quantity, 0) as current_stock,\r\n          CASE WHEN COALESCE(ps.quantity, 0) < 10 THEN TRUE ELSE FALSE END as needs_restock\r\n        FROM products p\r\n        LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n        WHERE p.id = ? AND p.deleted = FALSE`, [\n                parseInt(id)\n            ]);\n            if (products.length === 0) {\n                return res.status(404).json({\n                    error: \"Product not found\"\n                });\n            }\n            return res.status(200).json({\n                product: products[0],\n                currentPage: 1,\n                totalPages: 1,\n                totalItems: 1\n            });\n        }\n        // Count total products\n        let countQuery = \"SELECT COUNT(*) as total FROM products WHERE deleted = FALSE\";\n        let params = [];\n        if (category) {\n            countQuery += \" AND category = ?\";\n            params.push(category);\n        }\n        const [countResult] = await db.query(countQuery, params);\n        const totalItems = countResult[0].total;\n        const totalPages = Math.ceil(totalItems / limit);\n        // Get paginated products with stock info\n        let productQuery = `\r\n      SELECT \r\n        p.*,\r\n        COALESCE(ps.quantity, 0) as current_stock,\r\n        CASE WHEN COALESCE(ps.quantity, 0) < 10 THEN TRUE ELSE FALSE END as needs_restock,\r\n        (SELECT COUNT(*) FROM product_stocks WHERE product_id = p.id) as stock_updates\r\n      FROM products p\r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      WHERE p.deleted = FALSE\r\n    `;\n        if (category) {\n            productQuery += \" AND p.category = ?\";\n            params = [\n                category\n            ];\n        }\n        productQuery += \" ORDER BY p.id ASC LIMIT ? OFFSET ?\";\n        params.push(parseInt(limit), offset);\n        const [products] = await db.query(productQuery, params);\n        // Calculate total stock value\n        const [stockValue] = await db.query(`\r\n      SELECT COALESCE(SUM(p.price * ps.quantity), 0) as total_value\r\n      FROM products p \r\n      LEFT JOIN product_stocks ps ON p.id = ps.product_id\r\n      WHERE p.deleted = FALSE\r\n    `);\n        res.status(200).json({\n            products,\n            currentPage: parseInt(page),\n            totalPages,\n            totalItems,\n            totalStockValue: stockValue[0].total_value\n        });\n    } catch (error) {\n        console.error(\"Error fetching products:\", error);\n        res.status(500).json({\n            error: \"Error fetching products\"\n        });\n    }\n}\nasync function handleGetTotalStock(req, res) {\n    try {\n        const [result] = await db.query(\"SELECT SUM(stock_quantity) as totalStock FROM products\");\n        res.status(200).json({\n            totalStock: result[0].totalStock\n        });\n    } catch (error) {\n        console.error(\"Error fetching total stock:\", error);\n        res.status(500).json({\n            error: \"Error fetching total stock\"\n        });\n    }\n}\nasync function handleAddProduct(req, res) {\n    const { name, description, price, image_url, category, supplier_id } = req.body;\n    const sql = \"INSERT INTO products (name, description, price, image_url, category, supplier_id, stock_quantity) VALUES (?, ?, ?, ?, ?, ?, ?)\";\n    try {\n        // Set initial stock_quantity to 0 in products table\n        const [result] = await db.query(sql, [\n            name,\n            description,\n            price,\n            image_url,\n            category,\n            supplier_id,\n            0\n        ]);\n        // Remove the automatic stock entry creation\n        // Now stocks will only be added through the Stocks Management interface\n        res.status(201).json({\n            message: \"Product added successfully\",\n            id: result.insertId\n        });\n    } catch (error) {\n        console.error(\"Error adding product:\", error);\n        res.status(500).json({\n            error: \"Error adding product\"\n        });\n    }\n}\nasync function handleUpdateProduct(req, res, id) {\n    const { name, description, price, image_url, stock_quantity, category, supplier_id } = req.body;\n    const sql = \"UPDATE products SET name=?, description=?, price=?, image_url=?, stock_quantity=?, category=?, supplier_id=? WHERE id=?\";\n    try {\n        const [result] = await db.query(sql, [\n            name,\n            description,\n            price,\n            image_url,\n            stock_quantity,\n            category,\n            supplier_id,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Product not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Product updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating product:\", error);\n        res.status(500).json({\n            error: \"Error updating product\"\n        });\n    }\n}\nasync function handleDeleteProduct(req, res, id) {\n    const sql = \"UPDATE products SET deleted = TRUE WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Product not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Product marked as deleted successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error marking product as deleted:\", error);\n        res.status(500).json({\n            error: \"Error marking product as deleted\"\n        });\n    }\n}\n// Stocks\nasync function handleGetStocks(req, res) {\n    const page = parseInt(req.query.page) || 1;\n    const limit = parseInt(req.query.limit) || 10;\n    const offset = (page - 1) * limit;\n    try {\n        const [stocks] = await db.query(`\r\n      SELECT \r\n        ps.id,\r\n        ps.product_id,\r\n        p.name,\r\n        ps.quantity,\r\n        ps.last_updated,\r\n        CASE WHEN ps.quantity < 10 THEN TRUE ELSE FALSE END as low_stock\r\n      FROM product_stocks ps\r\n      JOIN products p ON ps.product_id = p.id\r\n      WHERE p.deleted = FALSE\r\n      ORDER BY ps.last_updated DESC\r\n      LIMIT ? OFFSET ?`, [\n            limit,\n            offset\n        ]);\n        const [countResult] = await db.query(\"SELECT COUNT(*) as total FROM product_stocks ps JOIN products p ON ps.product_id = p.id WHERE p.deleted = FALSE\");\n        const totalItems = countResult[0].total;\n        const totalPages = Math.ceil(totalItems / limit);\n        res.status(200).json({\n            stocks,\n            currentPage: page,\n            totalPages,\n            totalItems\n        });\n    } catch (error) {\n        console.error(\"Error fetching stocks:\", error);\n        res.status(500).json({\n            error: \"Error fetching stocks\"\n        });\n    }\n}\nasync function handleAddStock(req, res) {\n    const { id, product_id, quantity } = req.body;\n    if (!product_id || !quantity || !id) {\n        return res.status(400).json({\n            error: \"Stock ID, Product ID and quantity are required\"\n        });\n    }\n    try {\n        await db.query(\"START TRANSACTION\");\n        // Check if product exists\n        const [product] = await db.query(\"SELECT id FROM products WHERE id = ? AND deleted = FALSE\", [\n            product_id\n        ]);\n        if (product.length === 0) {\n            await db.query(\"ROLLBACK\");\n            return res.status(404).json({\n                error: \"Product not found\"\n            });\n        }\n        // Check if stock entry exists\n        const [existingStock] = await db.query(\"SELECT * FROM product_stocks WHERE id = ? OR product_id = ?\", [\n            id,\n            product_id\n        ]);\n        if (existingStock.length > 0) {\n            // Check for conflicts\n            const stockEntry = existingStock[0];\n            // Case 1: Using existing stock ID with different product\n            if (stockEntry.id === parseInt(id) && stockEntry.product_id !== parseInt(product_id)) {\n                await db.query(\"ROLLBACK\");\n                return res.status(400).json({\n                    error: `Stock ID ${id} is already assigned to Product ID ${stockEntry.product_id}`\n                });\n            }\n            // Case 2: Product has different stock ID\n            if (stockEntry.product_id === parseInt(product_id) && stockEntry.id !== parseInt(id)) {\n                await db.query(\"ROLLBACK\");\n                return res.status(400).json({\n                    error: `Product ID ${product_id} already has Stock ID ${stockEntry.id}`\n                });\n            }\n            // Case 3: Valid update - add new quantity to existing\n            const newQuantity = stockEntry.quantity + parseInt(quantity);\n            await db.query(`UPDATE product_stocks \r\n         SET quantity = ?, last_updated = NOW() \r\n         WHERE id = ? AND product_id = ?`, [\n                newQuantity,\n                id,\n                product_id\n            ]);\n            await db.query(\"COMMIT\");\n            // Fetch the updated stock to confirm\n            const [updatedStock] = await db.query(\"SELECT * FROM product_stocks WHERE id = ?\", [\n                id\n            ]);\n            res.status(200).json({\n                message: \"Stock updated successfully\",\n                id,\n                product_id,\n                previousQuantity: stockEntry.quantity,\n                addedQuantity: parseInt(quantity),\n                newQuantity: updatedStock[0].quantity,\n                needsRestock: updatedStock[0].quantity < 10\n            });\n        } else {\n            // Insert new stock entry\n            await db.query(\"INSERT INTO product_stocks (id, product_id, quantity, last_updated) VALUES (?, ?, ?, NOW())\", [\n                id,\n                product_id,\n                quantity\n            ]);\n            await db.query(\"COMMIT\");\n            res.status(201).json({\n                message: \"Stock added successfully\",\n                id,\n                product_id,\n                quantity: parseInt(quantity),\n                needsRestock: parseInt(quantity) < 10\n            });\n        }\n    } catch (error) {\n        await db.query(\"ROLLBACK\");\n        console.error(\"Error managing stock:\", error);\n        res.status(500).json({\n            error: \"Error managing stock: \" + error.message\n        });\n    }\n}\nasync function handleUpdateStock(req, res, id) {\n    const { quantity } = req.body;\n    try {\n        // First, get the current stock\n        const [existingStock] = await db.query(\"SELECT * FROM product_stocks WHERE id = ?\", [\n            id\n        ]);\n        if (existingStock.length === 0) {\n            return res.status(404).json({\n                error: \"Stock entry not found\"\n            });\n        }\n        // Calculate the new quantity (current + added)\n        const newQuantity = quantity;\n        // Update the stock quantity\n        const sql = `\r\n      UPDATE product_stocks \r\n      SET quantity = ?,\r\n          last_updated = NOW()\r\n      WHERE id = ?\r\n    `;\n        const [result] = await db.query(sql, [\n            newQuantity,\n            id\n        ]);\n        // Also update the stock_quantity in products table\n        await db.query(\"UPDATE products SET stock_quantity = ? WHERE id = ?\", [\n            newQuantity,\n            existingStock[0].product_id\n        ]);\n        res.status(200).json({\n            message: \"Stock updated successfully\",\n            updatedStock: {\n                id,\n                quantity: newQuantity,\n                last_updated: new Date()\n            }\n        });\n    } catch (error) {\n        console.error(\"Error updating stock:\", error);\n        res.status(500).json({\n            error: \"Error updating stock\"\n        });\n    }\n}\nasync function handleDeleteStock(req, res, id) {\n    try {\n        // First get the stock to update product quantity\n        const [stock] = await db.query(\"SELECT * FROM product_stocks WHERE id = ?\", [\n            id\n        ]);\n        if (stock.length === 0) {\n            return res.status(404).json({\n                error: \"Stock not found\"\n            });\n        }\n        // Delete the stock record\n        await db.query(\"DELETE FROM product_stocks WHERE id = ?\", [\n            id\n        ]);\n        // Update the product's stock_quantity\n        await db.query(\"UPDATE products SET stock_quantity = stock_quantity - ? WHERE id = ?\", [\n            stock[0].quantity,\n            stock[0].product_id\n        ]);\n        res.status(200).json({\n            message: \"Stock deleted successfully\"\n        });\n    } catch (error) {\n        console.error(\"Error deleting stock:\", error);\n        res.status(500).json({\n            error: \"Error deleting stock\"\n        });\n    }\n}\n//Order Monitoring\nasync function handleGetSalesReport(req, res) {\n    try {\n        const [result] = await db.query(`\r\n      SELECT \r\n        o.*,\r\n        GROUP_CONCAT(CONCAT(op.name, ' (', op.quantity, ')') SEPARATOR ', ') AS ordered_products\r\n      FROM orders o\r\n      LEFT JOIN ordered_products op ON o.id = op.order_id\r\n      WHERE o.in_sales_report = 1\r\n      GROUP BY o.id\r\n      ORDER BY o.order_date DESC\r\n    `);\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching sales report:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching sales report data\"\n        });\n    }\n}\nasync function handleUpdateOrderStatus(req, res, id) {\n    const { status } = req.body;\n    console.log(\"Updating order status:\", id, status);\n    const sql = \"UPDATE orders SET status = ? WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            status,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order status updated successfully\",\n                status: status\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating order status:\", error);\n        res.status(500).json({\n            error: \"Error updating order status\"\n        });\n    }\n}\nasync function handleCancelOrder(req, res, id) {\n    const sql = \"UPDATE orders SET status = 'Cancelled' WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order cancelled successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error cancelling order:\", error);\n        res.status(500).json({\n            error: \"Error cancelling order\"\n        });\n    }\n}\nasync function handleUpdateOrder(req, res, id) {\n    const { order_date } = req.body;\n    const sql = \"UPDATE orders SET order_date = ? WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            order_date,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order date updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating order date:\", error);\n        res.status(500).json({\n            error: \"Error updating order date\"\n        });\n    }\n}\nasync function handleRemoveOrderFromSalesReport(req, res) {\n    const { id } = req.query;\n    const sql = \"UPDATE orders SET in_sales_report = 0 WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order removed from sales report successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error removing order from sales report:\", error);\n        res.status(500).json({\n            error: \"Error removing order from sales report\"\n        });\n    }\n}\nasync function handleGetOrders(req, res) {\n    try {\n        const [result] = await db.query(`\r\n      SELECT o.*, \r\n             GROUP_CONCAT(\r\n               CONCAT(\r\n                 op.name, \r\n                 ' (', op.quantity, ')',\r\n                 ' [', IFNULL(p.image_url, ''), ']'\r\n               ) \r\n               SEPARATOR ', '\r\n             ) AS ordered_products\r\n      FROM orders o\r\n      LEFT JOIN ordered_products op ON o.id = op.order_id\r\n      LEFT JOIN products p ON op.product_id = p.id\r\n      WHERE o.in_sales_report = 1\r\n      GROUP BY o.id\r\n    `);\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching orders:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching orders\"\n        });\n    }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL1suLi5uZXh0YXBpXS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBbUM7QUFDUDtBQUNnQjtBQUNMO0FBRXZDLE1BQU1LLEtBQUtMLGdFQUFnQixDQUFDO0lBQzFCTyxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLFVBQVU7SUFDNUJDLE1BQU1ILFFBQVFDLEdBQUcsQ0FBQ0csVUFBVTtJQUM1QkMsTUFBTUwsUUFBUUMsR0FBRyxDQUFDSyxVQUFVO0lBQzVCQyxVQUFVUCxRQUFRQyxHQUFHLENBQUNPLGNBQWM7SUFDcENDLFVBQVVULFFBQVFDLEdBQUcsQ0FBQ1MsY0FBYztJQUNwQ0Msb0JBQW9CO0lBQ3BCQyxpQkFBaUI7SUFDakJDLFlBQVk7QUFDZDtBQUVlLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxNQUFNLEVBQUVDLE1BQU0sRUFBRSxHQUFHRjtJQUNuQixNQUFNLEVBQUVHLFFBQVEsRUFBRXRCLEtBQUssRUFBRSxHQUFHSCwwQ0FBS0EsQ0FBQ3NCLElBQUlJLEdBQUcsRUFBRTtJQUUzQ0MsUUFBUUMsR0FBRyxDQUFDLHFCQUFxQkosUUFBUUMsVUFBVXRCO0lBRW5ELElBQUlzQixhQUFhLGFBQWE7UUFDNUJGLElBQUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFxQjtRQUNyRDtJQUNGO0lBRUEsSUFBSU4sYUFBYSxtQkFBbUI7UUFDbEMsSUFBSTtZQUNGLE1BQU0sQ0FBQ08sUUFBUSxHQUFHLE1BQU01QixHQUFHRCxLQUFLLENBQUM7WUFDakMsSUFBSTZCLFFBQVFDLE1BQU0sR0FBRyxHQUFHO2dCQUN0QlYsSUFBSU0sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFBRUksVUFBVUYsT0FBTyxDQUFDLEVBQUUsQ0FBQ0csU0FBUztnQkFBQztZQUN4RCxPQUFPO2dCQUNMWixJQUFJTSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFTSxPQUFPO2dCQUFr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QUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRU0sT0FBTztRQUEwQztJQUMxRTtBQUNGO0FBRWlDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWRtaW5wYW5lbC8uL3NyYy9wYWdlcy9hcGkvWy4uLm5leHRhcGldLmpzPzI4NzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcclxuaW1wb3J0IHsgcGFyc2UgfSBmcm9tICd1cmwnO1xyXG5pbXBvcnQgeyBzaWduLCB2ZXJpZnkgfSBmcm9tICdqc29ud2VidG9rZW4nO1xyXG5pbXBvcnQgeyBxdWVyeSB9IGZyb20gJy4uLy4uL3V0aWxzL2RiJztcclxuXHJcbmNvbnN0IGRiID0gbXlzcWwuY3JlYXRlUG9vbCh7XHJcbiAgaG9zdDogcHJvY2Vzcy5lbnYuTVlTUUxfSE9TVCxcclxuICBwb3J0OiBwcm9jZXNzLmVudi5NWVNRTF9QT1JULFxyXG4gIHVzZXI6IHByb2Nlc3MuZW52Lk1ZU1FMX1VTRVIsXHJcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52Lk1ZU1FMX1BBU1NXT1JELFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcclxuICB3YWl0Rm9yQ29ubmVjdGlvbnM6IHRydWUsXHJcbiAgY29ubmVjdGlvbkxpbWl0OiAxMCxcclxuICBxdWV1ZUxpbWl0OiAwXHJcbn0pO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgbWV0aG9kIH0gPSByZXE7XHJcbiAgY29uc3QgeyBwYXRobmFtZSwgcXVlcnkgfSA9IHBhcnNlKHJlcS51cmwsIHRydWUpO1xyXG5cclxuICBjb25zb2xlLmxvZygnUmVjZWl2ZWQgcmVxdWVzdDonLCBtZXRob2QsIHBhdGhuYW1lLCBxdWVyeSk7XHJcblxyXG4gIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdGVzdCcpIHtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ1Rlc3Qgcm91dGUgd29ya2luZycgfSk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2FkbWluLW5hbWUnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIGZ1bGxfbmFtZSBGUk9NIGFkbWluIExJTUlUIDEnKTtcclxuICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgZnVsbE5hbWU6IHJlc3VsdHNbMF0uZnVsbF9uYW1lIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBZG1pbiBub3QgZm91bmQnIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBhZG1pbiBuYW1lOicsIGVycm9yKTtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGFkbWluIG5hbWUnIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIHN3aXRjaCAobWV0aG9kKSB7XHJcbiAgICAgIGNhc2UgJ0dFVCc6XHJcbiAgICBcclxuICAgICAgICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2NoZWNrLWF1dGgnKSB7XHJcbiAgICAgICAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcclxuICAgICAgICAgIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlLCB1c2VybmFtZVBhc3N3b3JkVmVyaWZpZWQ6IGZhbHNlIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgICAgICAgICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZGVjb2RlZC5leHAgJiYgZGVjb2RlZC5leHAgPiBub3cpIHtcclxuICAgICAgICAgICAgICAvLyBUb2tlbiBpcyBzdGlsbCB2YWxpZFxyXG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxyXG4gICAgICAgICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiB0cnVlLCBcclxuICAgICAgICAgICAgICAgIHVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGV4cGlyZXNJbjogZGVjb2RlZC5leHAgLSBub3dcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvLyBUb2tlbiBoYXMgZXhwaXJlZFxyXG4gICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlzQXV0aGVudGljYXRlZDogZmFsc2UsIHVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlzQXV0aGVudGljYXRlZDogZmFsc2UsIHVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3Byb2R1Y3RzJykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlR2V0UHJvZHVjdHMocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3N0b2NrcycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFN0b2NrcyhyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdG90YWwtc3RvY2snKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRUb3RhbFN0b2NrKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zYWxlcy1yZXBvcnQnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRTYWxlc1JlcG9ydChyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvc2FsZXMtZGF0YScpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFNhbGVzRGF0YShyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvdG90YWwtcHJvZHVjdHMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRUb3RhbFByb2R1Y3RzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS90b3AtcHJvZHVjdHMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRUb3BQcm9kdWN0cyhyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvcmF0ZWQtcHJvZHVjdHMtY291bnQnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRSYXRlZFByb2R1Y3RzQ291bnQocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2xvZ291dCcpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUxvZ291dChyZXEsIHJlcyk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvb3JkZXJzJykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlR2V0T3JkZXJzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvYWRtaW4tZGF0YScpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldEFkbWluRGF0YShyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvc2Vzc2lvbi1oaXN0b3J5Jykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlR2V0U2Vzc2lvbkhpc3RvcnkocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9wcm9kdWN0LWFuYWx5dGljcycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFByb2R1Y3RBbmFseXRpY3MocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3Byb2R1Y3QtcGVyZm9ybWFuY2UnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRQcm9kdWN0UGVyZm9ybWFuY2UocmVxLCByZXMpO1xyXG4gICAgICAgIH0gIGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9kYWlseS1zYWxlcycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldERhaWx5U2FsZXMocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3dlZWtseS1zYWxlcycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFdlZWtseVNhbGVzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9tb250aGx5LXNhbGVzJykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlR2V0TW9udGhseVNhbGVzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS95ZWFybHktc2FsZXMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRZZWFybHlTYWxlcyhyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvb3JkZXItZGV0YWlscycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldE9yZGVyRGV0YWlscyhyZXEsIHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnUE9TVCc6XHJcbiAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zaWduaW4nKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVTaWduSW4ocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3ZhbGlkYXRlLXBpbicpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZVZhbGlkYXRlUGluKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvcHJvZHVjdHMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVBZGRQcm9kdWN0KHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zdG9ja3MnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVBZGRTdG9jayhyZXEsIHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBcclxuICAgICAgY2FzZSAnUFVUJzpcclxuICAgICAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9wcm9kdWN0cy8nKSkge1xyXG4gICAgICAgICAgY29uc3QgaWQgPSBwYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpO1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlVXBkYXRlUHJvZHVjdChyZXEsIHJlcywgaWQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9zdG9ja3MvJykpIHtcclxuICAgICAgICAgIGNvbnN0IGlkID0gcGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKTtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZVVwZGF0ZVN0b2NrKHJlcSwgcmVzLCBpZCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL29yZGVycy8nKSkge1xyXG4gICAgY29uc3QgcGFydHMgPSBwYXRobmFtZS5zcGxpdCgnLycpO1xyXG4gICAgY29uc3QgaWQgPSBwYXJ0c1szXTsgLy8gVGhpcyBpcyB0aGUgb3JkZXIgSURcclxuICAgIGlmIChwYXJ0c1s0XSA9PT0gJ3N0YXR1cycpIHtcclxuICAgICAgYXdhaXQgaGFuZGxlVXBkYXRlT3JkZXJTdGF0dXMocmVxLCByZXMsIGlkKTtcclxuICAgIH0gZWxzZSBpZiAocGFydHNbNF0gPT09ICdjYW5jZWwnKSB7XHJcbiAgICAgIGF3YWl0IGhhbmRsZUNhbmNlbE9yZGVyKHJlcSwgcmVzLCBpZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhd2FpdCBoYW5kbGVVcGRhdGVPcmRlcihyZXEsIHJlcywgaWQpO1xyXG4gICAgfVxyXG4gIH1cclxuICBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3VwZGF0ZS1hZG1pbicpIHtcclxuICAgIGF3YWl0IGhhbmRsZVVwZGF0ZUFkbWluRGF0YShyZXEsIHJlcyk7XHJcbiAgfVxyXG4gIGJyZWFrO1xyXG4gIGNhc2UgJ0RFTEVURSc6XHJcbiAgICAgICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvcHJvZHVjdHMvJykpIHtcclxuICAgICAgICAgIGNvbnN0IGlkID0gcGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKTtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZURlbGV0ZVByb2R1Y3QocmVxLCByZXMsIGlkKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvc3RvY2tzLycpKSB7XHJcbiAgICAgICAgICBjb25zdCBpZCA9IHBhdGhuYW1lLnNwbGl0KCcvJykucG9wKCk7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVEZWxldGVTdG9jayhyZXEsIHJlcywgaWQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9vcmRlcnMvJykgJiYgcGF0aG5hbWUuZW5kc1dpdGgoJy9zYWxlc3JlcG9ydCcpKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVSZW1vdmVPcmRlckZyb21TYWxlc1JlcG9ydChyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ0dFVCcsICdQT1NUJywgJ1BVVCcsICdERUxFVEUnXSk7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDUpLmVuZChgTWV0aG9kICR7bWV0aG9kfSBOb3QgQWxsb3dlZGApO1xyXG4gICAgfVxyXG5cclxuICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnUm91dGUgbm90IGZvdW5kJyB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gQVBJIHJvdXRlOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdCcgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuLy9TYWxlcyBSZXBvcnQgXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldE9yZGVyRGV0YWlscyhyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgZGF0ZSB9ID0gcmVxLnF1ZXJ5O1xyXG4gIGxldCBkYXRlQ29uZGl0aW9uO1xyXG4gIFxyXG4gIGlmICghZGF0ZSkge1xyXG4gICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKG8ub3JkZXJfZGF0ZSkgPSBDVVJEQVRFKCknO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zdCBxdWVyeURhdGUgPSBuZXcgRGF0ZShkYXRlKTtcclxuICAgIGRhdGVDb25kaXRpb24gPSBgREFURShvLm9yZGVyX2RhdGUpID0gREFURSgnJHtxdWVyeURhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfScpYDtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICAgIFNFTEVDVCBcclxuICAgICAgICBvLm9yZGVyX2RhdGUsXHJcbiAgICAgICAgby5mdWxsX25hbWUsXHJcbiAgICAgICAgb3AubmFtZSBhcyBwcm9kdWN0X25hbWUsXHJcbiAgICAgICAgb3AucXVhbnRpdHksXHJcbiAgICAgICAgby50b3RhbCxcclxuICAgICAgICBwLmltYWdlX3VybFxyXG4gICAgICBGUk9NIG9yZGVycyBvXHJcbiAgICAgIEpPSU4gb3JkZXJlZF9wcm9kdWN0cyBvcCBPTiBvLmlkID0gb3Aub3JkZXJfaWRcclxuICAgICAgSk9JTiBwcm9kdWN0cyBwIE9OIG9wLnByb2R1Y3RfaWQgPSBwLmlkXHJcbiAgICAgIFdIRVJFIFxyXG4gICAgICAgICR7ZGF0ZUNvbmRpdGlvbn1cclxuICAgICAgICBBTkQgby5zdGF0dXMgPSAnRGVsaXZlcmVkJ1xyXG4gICAgICAgIEFORCBvLmluX3NhbGVzX3JlcG9ydCA9IDFcclxuICAgICAgT1JERVIgQlkgby5vcmRlcl9kYXRlIERFU0NcclxuICAgIGApO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBvcmRlciBkZXRhaWxzOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBmZXRjaGluZyBvcmRlciBkZXRhaWxzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldE1vbnRobHlTYWxlcyhyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgeWVhciB9ID0gcmVxLnF1ZXJ5O1xyXG4gIGNvbnN0IGN1cnJlbnRZZWFyID0geWVhciB8fCBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICAgIFNFTEVDVCBcclxuICAgICAgICBNT05USChvcmRlcl9kYXRlKSBhcyBtb250aCxcclxuICAgICAgICBTVU0oQ0FTRSBXSEVOIHN0YXR1cyA9ICdEZWxpdmVyZWQnIEFORCBpbl9zYWxlc19yZXBvcnQgPSAxIFRIRU4gMSBFTFNFIDAgRU5EKSBhcyBvcmRlckNvdW50LFxyXG4gICAgICAgIENBU1QoQ09BTEVTQ0UoU1VNKENBU0UgV0hFTiBzdGF0dXMgPSAnRGVsaXZlcmVkJyBBTkQgaW5fc2FsZXNfcmVwb3J0ID0gMSBUSEVOIHRvdGFsIEVMU0UgMCBFTkQpLCAwKSBBUyBERUNJTUFMKDEwLDIpKSBhcyB0b3RhbCxcclxuICAgICAgICBTVU0oQ0FTRSBXSEVOIHN0YXR1cyA9ICdDYW5jZWxsZWQnIFRIRU4gMSBFTFNFIDAgRU5EKSBhcyBjYW5jZWxsZWRDb3VudCxcclxuICAgICAgICBDQVNUKENPQUxFU0NFKFNVTShDQVNFIFdIRU4gc3RhdHVzID0gJ0NhbmNlbGxlZCcgVEhFTiB0b3RhbCBFTFNFIDAgRU5EKSwgMCkgQVMgREVDSU1BTCgxMCwyKSkgYXMgY2FuY2VsbGVkVG90YWxcclxuICAgICAgRlJPTSBvcmRlcnNcclxuICAgICAgV0hFUkUgWUVBUihvcmRlcl9kYXRlKSA9ID9cclxuICAgICAgR1JPVVAgQlkgTU9OVEgob3JkZXJfZGF0ZSlcclxuICAgICAgT1JERVIgQlkgbW9udGhcclxuICAgIGAsIFtjdXJyZW50WWVhcl0pO1xyXG5cclxuICAgIGNvbnN0IGZvcm1hdHRlZFJlc3VsdHMgPSByZXN1bHRzLm1hcChyb3cgPT4gKHtcclxuICAgICAgbW9udGg6IHJvdy5tb250aCxcclxuICAgICAgb3JkZXJDb3VudDogTnVtYmVyKHJvdy5vcmRlckNvdW50KSxcclxuICAgICAgdG90YWw6IE51bWJlcihyb3cudG90YWwpLFxyXG4gICAgICBjYW5jZWxsZWRDb3VudDogTnVtYmVyKHJvdy5jYW5jZWxsZWRDb3VudCksXHJcbiAgICAgIGNhbmNlbGxlZFRvdGFsOiBOdW1iZXIocm93LmNhbmNlbGxlZFRvdGFsKVxyXG4gICAgfSkpO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGZvcm1hdHRlZFJlc3VsdHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBtb250aGx5IHNhbGVzOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBmZXRjaGluZyBtb250aGx5IHNhbGVzIGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0RGFpbHlTYWxlcyhyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICAgIFNFTEVDVCBcclxuICAgICAgICBEQVlPRldFRUsob3JkZXJfZGF0ZSkgYXMgcGVyaW9kLFxyXG4gICAgICAgIFNVTShDQVNFIFdIRU4gc3RhdHVzID0gJ0RlbGl2ZXJlZCcgQU5EIGluX3NhbGVzX3JlcG9ydCA9IDEgVEhFTiAxIEVMU0UgMCBFTkQpIGFzIG9yZGVycyxcclxuICAgICAgICBDQVNUKENPQUxFU0NFKFNVTShDQVNFIFdIRU4gc3RhdHVzID0gJ0RlbGl2ZXJlZCcgQU5EIGluX3NhbGVzX3JlcG9ydCA9IDEgVEhFTiB0b3RhbCBFTFNFIDAgRU5EKSwgMCkgQVMgREVDSU1BTCgxMCwyKSkgYXMgdG90YWwsXHJcbiAgICAgICAgU1VNKENBU0UgV0hFTiBzdGF0dXMgPSAnQ2FuY2VsbGVkJyBUSEVOIDEgRUxTRSAwIEVORCkgYXMgY2FuY2VsbGVkT3JkZXJzLFxyXG4gICAgICAgIENBU1QoQ09BTEVTQ0UoU1VNKENBU0UgV0hFTiBzdGF0dXMgPSAnQ2FuY2VsbGVkJyBUSEVOIHRvdGFsIEVMU0UgMCBFTkQpLCAwKSBBUyBERUNJTUFMKDEwLDIpKSBhcyBjYW5jZWxsZWRUb3RhbFxyXG4gICAgICBGUk9NIG9yZGVyc1xyXG4gICAgICBXSEVSRSBZRUFSV0VFSyhvcmRlcl9kYXRlKSA9IFlFQVJXRUVLKENVUkRBVEUoKSlcclxuICAgICAgR1JPVVAgQlkgREFZT0ZXRUVLKG9yZGVyX2RhdGUpXHJcbiAgICAgIE9SREVSIEJZIHBlcmlvZFxyXG4gICAgYCk7XHJcblxyXG4gICAgY29uc3QgZGF5c09mV2VlayA9IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXTtcclxuICAgIGNvbnN0IGZ1bGxXZWVrRGF0YSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDcgfSwgKF8sIGkpID0+ICh7XHJcbiAgICAgIHBlcmlvZDogZGF5c09mV2Vla1tpXSxcclxuICAgICAgb3JkZXJzOiAwLFxyXG4gICAgICB0b3RhbDogMCxcclxuICAgICAgY2FuY2VsbGVkT3JkZXJzOiAwLFxyXG4gICAgICBjYW5jZWxsZWRUb3RhbDogMFxyXG4gICAgfSkpO1xyXG5cclxuICAgIHJlc3VsdHMuZm9yRWFjaChyb3cgPT4ge1xyXG4gICAgICBjb25zdCBkYXlJbmRleCA9IHJvdy5wZXJpb2QgLSAxO1xyXG4gICAgICBmdWxsV2Vla0RhdGFbZGF5SW5kZXhdID0ge1xyXG4gICAgICAgIHBlcmlvZDogZGF5c09mV2Vla1tkYXlJbmRleF0sXHJcbiAgICAgICAgb3JkZXJzOiBOdW1iZXIocm93Lm9yZGVycyksXHJcbiAgICAgICAgdG90YWw6IE51bWJlcihyb3cudG90YWwpLFxyXG4gICAgICAgIGNhbmNlbGxlZE9yZGVyczogTnVtYmVyKHJvdy5jYW5jZWxsZWRPcmRlcnMpLFxyXG4gICAgICAgIGNhbmNlbGxlZFRvdGFsOiBOdW1iZXIocm93LmNhbmNlbGxlZFRvdGFsKVxyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZnVsbFdlZWtEYXRhKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgZGFpbHkgc2FsZXM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGZldGNoaW5nIGRhaWx5IHNhbGVzIGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0V2Vla2x5U2FsZXMocmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdHNdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgXHJcbiAgICAgICAgV0VFSyhvcmRlcl9kYXRlKSBhcyB3ZWVrTnVtYmVyLFxyXG4gICAgICAgIE1JTihEQVRFKG9yZGVyX2RhdGUpKSBhcyB3ZWVrU3RhcnQsXHJcbiAgICAgICAgTUFYKERBVEUob3JkZXJfZGF0ZSkpIGFzIHdlZWtFbmQsXHJcbiAgICAgICAgU1VNKENBU0UgV0hFTiBzdGF0dXMgPSAnRGVsaXZlcmVkJyBBTkQgaW5fc2FsZXNfcmVwb3J0ID0gMSBUSEVOIDEgRUxTRSAwIEVORCkgYXMgb3JkZXJzLFxyXG4gICAgICAgIENBU1QoQ09BTEVTQ0UoU1VNKENBU0UgV0hFTiBzdGF0dXMgPSAnRGVsaXZlcmVkJyBBTkQgaW5fc2FsZXNfcmVwb3J0ID0gMSBUSEVOIHRvdGFsIEVMU0UgMCBFTkQpLCAwKSBBUyBERUNJTUFMKDEwLDIpKSBhcyB0b3RhbCxcclxuICAgICAgICBTVU0oQ0FTRSBXSEVOIHN0YXR1cyA9ICdDYW5jZWxsZWQnIFRIRU4gMSBFTFNFIDAgRU5EKSBhcyBjYW5jZWxsZWRPcmRlcnMsXHJcbiAgICAgICAgQ0FTVChDT0FMRVNDRShTVU0oQ0FTRSBXSEVOIHN0YXR1cyA9ICdDYW5jZWxsZWQnIFRIRU4gdG90YWwgRUxTRSAwIEVORCksIDApIEFTIERFQ0lNQUwoMTAsMikpIGFzIGNhbmNlbGxlZFRvdGFsXHJcbiAgICAgIEZST00gb3JkZXJzXHJcbiAgICAgIFdIRVJFIG9yZGVyX2RhdGUgPj0gREFURV9TVUIoQ1VSREFURSgpLCBJTlRFUlZBTCA3IFdFRUspXHJcbiAgICAgIEdST1VQIEJZIFdFRUsob3JkZXJfZGF0ZSlcclxuICAgICAgT1JERVIgQlkgd2Vla051bWJlclxyXG4gICAgYCk7XHJcblxyXG4gICAgY29uc3QgZm9ybWF0dGVkUmVzdWx0cyA9IHJlc3VsdHMubWFwKHJvdyA9PiAoe1xyXG4gICAgICBwZXJpb2Q6IGBXZWVrICR7cm93LndlZWtOdW1iZXJ9ICgke25ldyBEYXRlKHJvdy53ZWVrU3RhcnQpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSAtICR7bmV3IERhdGUocm93LndlZWtFbmQpLnRvTG9jYWxlRGF0ZVN0cmluZygpfSlgLFxyXG4gICAgICBvcmRlcnM6IE51bWJlcihyb3cub3JkZXJzKSxcclxuICAgICAgdG90YWw6IE51bWJlcihyb3cudG90YWwpLFxyXG4gICAgICBjYW5jZWxsZWRPcmRlcnM6IE51bWJlcihyb3cuY2FuY2VsbGVkT3JkZXJzKSxcclxuICAgICAgY2FuY2VsbGVkVG90YWw6IE51bWJlcihyb3cuY2FuY2VsbGVkVG90YWwpXHJcbiAgICB9KSk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZm9ybWF0dGVkUmVzdWx0cyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHdlZWtseSBzYWxlczonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgd2Vla2x5IHNhbGVzIGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0WWVhcmx5U2FsZXMocmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY3VycmVudFllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIFxyXG4gICAgICAgIFlFQVIob3JkZXJfZGF0ZSkgYXMgcGVyaW9kLFxyXG4gICAgICAgIFNVTShDQVNFIFdIRU4gc3RhdHVzID0gJ0RlbGl2ZXJlZCcgQU5EIGluX3NhbGVzX3JlcG9ydCA9IDEgVEhFTiAxIEVMU0UgMCBFTkQpIGFzIG9yZGVycyxcclxuICAgICAgICBDQVNUKENPQUxFU0NFKFNVTShDQVNFIFdIRU4gc3RhdHVzID0gJ0RlbGl2ZXJlZCcgQU5EIGluX3NhbGVzX3JlcG9ydCA9IDEgVEhFTiB0b3RhbCBFTFNFIDAgRU5EKSwgMCkgQVMgREVDSU1BTCgxMCwyKSkgYXMgdG90YWwsXHJcbiAgICAgICAgU1VNKENBU0UgV0hFTiBzdGF0dXMgPSAnQ2FuY2VsbGVkJyBUSEVOIDEgRUxTRSAwIEVORCkgYXMgY2FuY2VsbGVkT3JkZXJzLFxyXG4gICAgICAgIENBU1QoQ09BTEVTQ0UoU1VNKENBU0UgV0hFTiBzdGF0dXMgPSAnQ2FuY2VsbGVkJyBUSEVOIHRvdGFsIEVMU0UgMCBFTkQpLCAwKSBBUyBERUNJTUFMKDEwLDIpKSBhcyBjYW5jZWxsZWRUb3RhbFxyXG4gICAgICBGUk9NIG9yZGVyc1xyXG4gICAgICBXSEVSRSBZRUFSKG9yZGVyX2RhdGUpID49ID9cclxuICAgICAgR1JPVVAgQlkgWUVBUihvcmRlcl9kYXRlKVxyXG4gICAgICBPUkRFUiBCWSBwZXJpb2RcclxuICAgIGAsIFtjdXJyZW50WWVhciAtIDRdKTtcclxuXHJcbiAgICBjb25zdCB5ZWFybHlEYXRhID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogNSB9LCAoXywgaW5kZXgpID0+IHtcclxuICAgICAgY29uc3QgeWVhciA9IGN1cnJlbnRZZWFyIC0gNCArIGluZGV4O1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHBlcmlvZDogeWVhci50b1N0cmluZygpLFxyXG4gICAgICAgIG9yZGVyczogMCxcclxuICAgICAgICB0b3RhbDogMCxcclxuICAgICAgICBjYW5jZWxsZWRPcmRlcnM6IDAsXHJcbiAgICAgICAgY2FuY2VsbGVkVG90YWw6IDBcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJlc3VsdHMuZm9yRWFjaChyb3cgPT4ge1xyXG4gICAgICBjb25zdCB5ZWFySW5kZXggPSByb3cucGVyaW9kIC0gKGN1cnJlbnRZZWFyIC0gNCk7XHJcbiAgICAgIGlmICh5ZWFySW5kZXggPj0gMCAmJiB5ZWFySW5kZXggPCA1KSB7XHJcbiAgICAgICAgeWVhcmx5RGF0YVt5ZWFySW5kZXhdID0ge1xyXG4gICAgICAgICAgcGVyaW9kOiByb3cucGVyaW9kLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICBvcmRlcnM6IE51bWJlcihyb3cub3JkZXJzKSxcclxuICAgICAgICAgIHRvdGFsOiBOdW1iZXIocm93LnRvdGFsKSxcclxuICAgICAgICAgIGNhbmNlbGxlZE9yZGVyczogTnVtYmVyKHJvdy5jYW5jZWxsZWRPcmRlcnMpLFxyXG4gICAgICAgICAgY2FuY2VsbGVkVG90YWw6IE51bWJlcihyb3cuY2FuY2VsbGVkVG90YWwpXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeWVhcmx5RGF0YSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHllYXJseSBzYWxlczonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgeWVhcmx5IHNhbGVzIGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0U2FsZXNEYXRhKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBkYXRlIH0gPSByZXEucXVlcnk7XHJcbiAgbGV0IGRhdGVDb25kaXRpb247XHJcbiAgXHJcbiAgaWYgKCFkYXRlKSB7XHJcbiAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUob3JkZXJfZGF0ZSkgPSBDVVJEQVRFKCknO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBjb25zdCBxdWVyeURhdGUgPSBuZXcgRGF0ZShkYXRlKTtcclxuICAgIGRhdGVDb25kaXRpb24gPSBgREFURShvcmRlcl9kYXRlKSA9IERBVEUoJyR7cXVlcnlEYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXX0nKWA7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3NhbGVzUmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIENPQUxFU0NFKFNVTSh0b3RhbCksIDApIGFzIHBlcmlvZFNhbGVzXHJcbiAgICAgIEZST00gb3JkZXJzXHJcbiAgICAgIFdIRVJFICR7ZGF0ZUNvbmRpdGlvbn0gQU5EIHN0YXR1cyA9ICdEZWxpdmVyZWQnXHJcbiAgICBgKTtcclxuXHJcbiAgICBjb25zdCBbb3JkZXJzUmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIENPVU5UKCopIGFzIHRvdGFsT3JkZXJzXHJcbiAgICAgIEZST00gb3JkZXJzXHJcbiAgICAgIFdIRVJFICR7ZGF0ZUNvbmRpdGlvbn1cclxuICAgIGApO1xyXG5cclxuICAgIGNvbnN0IFtjdXN0b21lcnNSZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgQ09VTlQoRElTVElOQ1QgdXNlcl9pZCkgYXMgdG90YWxDdXN0b21lcnNcclxuICAgICAgRlJPTSBvcmRlcnNcclxuICAgICAgV0hFUkUgJHtkYXRlQ29uZGl0aW9ufVxyXG4gICAgYCk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0ge1xyXG4gICAgICBwZXJpb2RTYWxlczogTnVtYmVyKHNhbGVzUmVzdWx0WzBdLnBlcmlvZFNhbGVzKSxcclxuICAgICAgdG90YWxPcmRlcnM6IG9yZGVyc1Jlc3VsdFswXS50b3RhbE9yZGVycyxcclxuICAgICAgdG90YWxDdXN0b21lcnM6IGN1c3RvbWVyc1Jlc3VsdFswXS50b3RhbEN1c3RvbWVyc1xyXG4gICAgfTtcclxuXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHQpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzYWxlcyBkYXRhOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBmZXRjaGluZyBzYWxlcyBkYXRhJyB9KTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRUb3BQcm9kdWN0cyhyZXEsIHJlcykge1xyXG4gIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgU0VMRUNUIFxyXG4gICAgICBwLmlkLFxyXG4gICAgICBwLm5hbWUsXHJcbiAgICAgIHAuaW1hZ2VfdXJsLFxyXG4gICAgICBDT0FMRVNDRShBVkcocHIucmF0aW5nKSwgMCkgYXMgYXZnX3JhdGluZyxcclxuICAgICAgQ09BTEVTQ0UoU1VNKG9wLnF1YW50aXR5KSwgMCkgYXMgc29sZFxyXG4gICAgRlJPTSBwcm9kdWN0cyBwXHJcbiAgICBMRUZUIEpPSU4gb3JkZXJlZF9wcm9kdWN0cyBvcCBPTiBwLmlkID0gb3AucHJvZHVjdF9pZFxyXG4gICAgTEVGVCBKT0lOIHByb2R1Y3RfcmF0aW5ncyBwciBPTiBwLmlkID0gcHIucHJvZHVjdF9pZFxyXG4gICAgR1JPVVAgQlkgcC5pZFxyXG4gICAgT1JERVIgQlkgc29sZCBERVNDLCBhdmdfcmF0aW5nIERFU0NcclxuICAgIExJTUlUIDVcclxuICBgKTtcclxuICBcclxuICBjb25zdCBmb3JtYXR0ZWRSZXN1bHQgPSByZXN1bHQubWFwKHByb2R1Y3QgPT4gKHtcclxuICAgIC4uLnByb2R1Y3QsXHJcbiAgICBhdmdfcmF0aW5nOiBOdW1iZXIocHJvZHVjdC5hdmdfcmF0aW5nKS50b0ZpeGVkKDEpXHJcbiAgfSkpO1xyXG4gIFxyXG4gIHJlcy5zdGF0dXMoMjAwKS5qc29uKGZvcm1hdHRlZFJlc3VsdCk7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFJhdGVkUHJvZHVjdHNDb3VudChyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgdGltZUZyYW1lIH0gPSByZXEucXVlcnk7XHJcbiAgbGV0IGRhdGVDb25kaXRpb247XHJcblxyXG4gIHN3aXRjaCAodGltZUZyYW1lKSB7XHJcbiAgICBjYXNlICd0b2RheSc6XHJcbiAgICAgIGRhdGVDb25kaXRpb24gPSAnREFURShjcmVhdGVkX2F0KSA9IENVUkRBVEUoKSc7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAneWVzdGVyZGF5JzpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKGNyZWF0ZWRfYXQpID0gREFURV9TVUIoQ1VSREFURSgpLCBJTlRFUlZBTCAxIERBWSknO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgJ2xhc3RXZWVrJzpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKGNyZWF0ZWRfYXQpIEJFVFdFRU4gREFURV9TVUIoQ1VSREFURSgpLCBJTlRFUlZBTCAxIFdFRUspIEFORCBDVVJEQVRFKCknO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgJ2xhc3RNb250aCc6XHJcbiAgICAgIGRhdGVDb25kaXRpb24gPSAnREFURShjcmVhdGVkX2F0KSBCRVRXRUVOIERBVEVfU1VCKENVUkRBVEUoKSwgSU5URVJWQUwgMSBNT05USCkgQU5EIENVUkRBVEUoKSc7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKGNyZWF0ZWRfYXQpID0gQ1VSREFURSgpJztcclxuICB9XHJcblxyXG4gIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgU0VMRUNUIENPVU5UKERJU1RJTkNUIHByb2R1Y3RfaWQpIGFzIHJhdGVkUHJvZHVjdHNDb3VudFxyXG4gICAgRlJPTSBwcm9kdWN0X3JhdGluZ3NcclxuICAgIFdIRVJFICR7ZGF0ZUNvbmRpdGlvbn1cclxuICBgKTtcclxuXHJcbiAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0WzBdKTtcclxufVxyXG5cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFRvdGFsUHJvZHVjdHMocmVxLCByZXMpIHtcclxuICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgQ09VTlQoKikgYXMgdG90YWxQcm9kdWN0cyBGUk9NIHByb2R1Y3RzJyk7XHJcbiAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0WzBdKTtcclxufVxyXG5cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFByb2R1Y3RBbmFseXRpY3MocmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgLy8gR2V0IHByb2R1Y3RzIHdpdGggdGhlaXIgcmF0aW5ncywgb3JkZXJzLCBhbmQgc3RvY2sgaW5mb3JtYXRpb25cclxuICAgIGNvbnN0IFtwcm9kdWN0c10gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICAgIFNFTEVDVCBcclxuICAgICAgICBwLiosXHJcbiAgICAgICAgQ09BTEVTQ0UocHMucXVhbnRpdHksIDApIGFzIHN0b2NrX3F1YW50aXR5LFxyXG4gICAgICAgIENPQUxFU0NFKEFWRyhwci5yYXRpbmcpLCAwKSBhcyBhdmdfcmF0aW5nLFxyXG4gICAgICAgIENPVU5UKERJU1RJTkNUIG8uaWQpIGFzIG9yZGVyX2NvdW50XHJcbiAgICAgIEZST00gcHJvZHVjdHMgcFxyXG4gICAgICBMRUZUIEpPSU4gcHJvZHVjdF9zdG9ja3MgcHMgT04gcC5pZCA9IHBzLnByb2R1Y3RfaWRcclxuICAgICAgTEVGVCBKT0lOIHByb2R1Y3RfcmF0aW5ncyBwciBPTiBwLmlkID0gcHIucHJvZHVjdF9pZFxyXG4gICAgICBMRUZUIEpPSU4gb3JkZXJlZF9wcm9kdWN0cyBvcCBPTiBwLmlkID0gb3AucHJvZHVjdF9pZFxyXG4gICAgICBMRUZUIEpPSU4gb3JkZXJzIG8gT04gb3Aub3JkZXJfaWQgPSBvLmlkXHJcbiAgICAgIFdIRVJFIHAuZGVsZXRlZCA9IEZBTFNFXHJcbiAgICAgIEdST1VQIEJZIHAuaWRcclxuICAgIGApO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBzYWxlYWJsZSBtZXRyaWNzXHJcbiAgICBjb25zdCBhbmFseXplZFByb2R1Y3RzID0gcHJvZHVjdHMubWFwKHByb2R1Y3QgPT4gKHtcclxuICAgICAgLi4ucHJvZHVjdCxcclxuICAgICAgaXNTYWxlYWJsZTogKFxyXG4gICAgICAgIHByb2R1Y3Qub3JkZXJfY291bnQgPiAwICYmXHJcbiAgICAgICAgcHJvZHVjdC5hdmdfcmF0aW5nID49IDMuNSAmJlxyXG4gICAgICAgIHByb2R1Y3Quc3RvY2tfcXVhbnRpdHkgPiAwXHJcbiAgICAgIClcclxuICAgIH0pKTtcclxuXHJcbiAgICBjb25zdCBzYWxlYWJsZVByb2R1Y3RzID0gYW5hbHl6ZWRQcm9kdWN0cy5maWx0ZXIocCA9PiBwLmlzU2FsZWFibGUpO1xyXG4gICAgY29uc3Qgbm9uU2FsZWFibGVQcm9kdWN0cyA9IGFuYWx5emVkUHJvZHVjdHMuZmlsdGVyKHAgPT4gIXAuaXNTYWxlYWJsZSk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICBzYWxlYWJsZVByb2R1Y3RzLFxyXG4gICAgICBub25TYWxlYWJsZVByb2R1Y3RzLFxyXG4gICAgICB0b3RhbFByb2R1Y3RzOiBwcm9kdWN0cy5sZW5ndGgsXHJcbiAgICAgIHNhbGVhYmxlQ291bnQ6IHNhbGVhYmxlUHJvZHVjdHMubGVuZ3RoLFxyXG4gICAgICBub25TYWxlYWJsZUNvdW50OiBub25TYWxlYWJsZVByb2R1Y3RzLmxlbmd0aFxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3QgYW5hbHl0aWNzOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBmZXRjaGluZyBwcm9kdWN0IGFuYWx5dGljcycgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRQcm9kdWN0UGVyZm9ybWFuY2UocmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgLy8gTW9kaWZpZWQgcXVlcnkgdG8gaW5jbHVkZSBkZXNjcmlwdGlvbiBhbmQgb3RoZXIgcmVsZXZhbnQgZmllbGRzXHJcbiAgICBjb25zdCBbcGVyZm9ybWFuY2VEYXRhXSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIFxyXG4gICAgICAgIHAuaWQsXHJcbiAgICAgICAgcC5uYW1lLFxyXG4gICAgICAgIHAuZGVzY3JpcHRpb24sICAgICBcclxuICAgICAgICBwLnByaWNlLFxyXG4gICAgICAgIHAuaW1hZ2VfdXJsLFxyXG4gICAgICAgIHAuY2F0ZWdvcnksICAgICAgICBcclxuICAgICAgICBDT1VOVChESVNUSU5DVCBvLmlkKSBhcyB0b3RhbF9vcmRlcnMsXHJcbiAgICAgICAgQ09BTEVTQ0UoU1VNKG9wLnF1YW50aXR5KSwgMCkgYXMgdG90YWxfdW5pdHNfc29sZCxcclxuICAgICAgICBDT0FMRVNDRShBVkcocHIucmF0aW5nKSwgMCkgYXMgYXZlcmFnZV9yYXRpbmcsXHJcbiAgICAgICAgQ09VTlQoRElTVElOQ1QgcHIuaWQpIGFzIHJhdGluZ19jb3VudCxcclxuICAgICAgICBwcy5xdWFudGl0eSBhcyBjdXJyZW50X3N0b2NrLFxyXG4gICAgICAgIHBzLmlkIGFzIHN0b2NrX2lkXHJcbiAgICAgIEZST00gcHJvZHVjdHMgcFxyXG4gICAgICBJTk5FUiBKT0lOIG9yZGVyZWRfcHJvZHVjdHMgb3AgT04gcC5pZCA9IG9wLnByb2R1Y3RfaWRcclxuICAgICAgTEVGVCBKT0lOIG9yZGVycyBvIE9OIG9wLm9yZGVyX2lkID0gby5pZCBBTkQgby5zdGF0dXMgIT0gJ2NhbmNlbGxlZCdcclxuICAgICAgTEVGVCBKT0lOIHByb2R1Y3RfcmF0aW5ncyBwciBPTiBwLmlkID0gcHIucHJvZHVjdF9pZFxyXG4gICAgICBMRUZUIEpPSU4gcHJvZHVjdF9zdG9ja3MgcHMgT04gcC5pZCA9IHBzLnByb2R1Y3RfaWRcclxuICAgICAgV0hFUkUgcC5kZWxldGVkID0gRkFMU0VcclxuICAgICAgR1JPVVAgQlkgcC5pZCwgcHMuaWQsIHAuZGVzY3JpcHRpb24sIHAuY2F0ZWdvcnkgXHJcbiAgICAgIE9SREVSIEJZIENPQUxFU0NFKFNVTShvcC5xdWFudGl0eSksIDApIERFU0NcclxuICAgIGApO1xyXG5cclxuICAgIC8vIEZpbHRlciBwcm9kdWN0cyBiYXNlZCBvbiB0aGUgY3JpdGVyaWFcclxuICAgIGNvbnN0IHNhbGVhYmxlUHJvZHVjdHMgPSBwZXJmb3JtYW5jZURhdGEuZmlsdGVyKHByb2R1Y3QgPT4gXHJcbiAgICAgIHByb2R1Y3QudG90YWxfdW5pdHNfc29sZCA+IDIwXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IG5vblNhbGVhYmxlUHJvZHVjdHMgPSBwZXJmb3JtYW5jZURhdGEuZmlsdGVyKHByb2R1Y3QgPT4gXHJcbiAgICAgIHByb2R1Y3QudG90YWxfdW5pdHNfc29sZCA8IDUgJiYgcHJvZHVjdC50b3RhbF91bml0c19zb2xkID4gMFxyXG4gICAgKTtcclxuXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgIHBlcmZvcm1hbmNlOiBwZXJmb3JtYW5jZURhdGEsXHJcbiAgICAgIHNhbGVhYmxlUHJvZHVjdHM6IHNhbGVhYmxlUHJvZHVjdHMuc2xpY2UoMCwgMTApLFxyXG4gICAgICBub25TYWxlYWJsZVByb2R1Y3RzOiBub25TYWxlYWJsZVByb2R1Y3RzLnNsaWNlKDAsIDEwKVxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3QgcGVyZm9ybWFuY2U6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3QgcGVyZm9ybWFuY2UnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8vTG9naW4gQXV0aGVudGljYXRpb24gYW5kIExvZ291dFxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVTaWduSW4ocmVxLCByZXMpIHtcclxuICBjb25zdCB7IHVzZXJuYW1lLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc29sZS5sb2coJ1NpZ25pbiBhdHRlbXB0OicsIHsgdXNlcm5hbWUgfSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUICogRlJPTSBhZG1pbiBXSEVSRSB1c2VybmFtZSA9ID8nLCBbdXNlcm5hbWVdKTtcclxuXHJcbiAgICBpZiAocmVzdWx0cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc29sZS5sb2coJ1VzZXIgbm90IGZvdW5kJyk7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCB1c2VybmFtZSBvciBwYXNzd29yZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdXNlciA9IHJlc3VsdHNbMF07XHJcbiAgICBcclxuICAgIGNvbnN0IHBhc3N3b3JkTWF0Y2ggPSBwYXNzd29yZCA9PT0gdXNlci5wYXNzd29yZDtcclxuXHJcbiAgICBpZiAoIXBhc3N3b3JkTWF0Y2gpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1Bhc3N3b3JkIG1pc21hdGNoJyk7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCB1c2VybmFtZSBvciBwYXNzd29yZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZGIucXVlcnkoJ0lOU0VSVCBJTlRPIGFkbWluX3Nlc3Npb25zIChhZG1pbl9pZCwgbG9naW5fdGltZSkgVkFMVUVTICg/LCBOT1coKSknLCBbdXNlci5pZF0pO1xyXG5cclxuICAgIGNvbnN0IHRva2VuID0gc2lnbih7IHVzZXJJZDogdXNlci5pZCB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzZoJyB9KTtcclxuICAgIGNvbnNvbGUubG9nKCdMb2dpbiBzdWNjZXNzZnVsLCB0b2tlbiBnZW5lcmF0ZWQnKTtcclxuICAgIFxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnU2lnbmluIHN1Y2Nlc3NmdWwnLCB1c2VybmFtZTogdXNlci51c2VybmFtZSwgdG9rZW46IHRva2VuIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdTaWduIGluIGVycm9yOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgc2lnbmluJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVZhbGlkYXRlUGluKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBwaW4gfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8uc3BsaXQoJyAnKVsxXTtcclxuXHJcbiAgaWYgKCF0b2tlbikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIHBpbiBGUk9NIGFkbWluIFdIRVJFIGlkID0gPycsIFtkZWNvZGVkLnVzZXJJZF0pO1xyXG4gICAgXHJcbiAgICBpZiAocmVzdWx0cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBZG1pbiBub3QgZm91bmQnIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHN0b3JlZFBpbiA9IHJlc3VsdHNbMF0ucGluO1xyXG4gICAgXHJcbiAgICBpZiAoU3RyaW5nKHBpbikgPT09IFN0cmluZyhzdG9yZWRQaW4pKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ1BJTiB2YWxpZGF0ZWQgc3VjY2Vzc2Z1bGx5JyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIFBJTicgfSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHZhbGlkYXRpbmcgUElOOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSB2YWxpZGF0aW5nIFBJTicgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVMb2dvdXQocmVxLCByZXMpIHtcclxuICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24/LnNwbGl0KCcgJylbMV07XHJcbiAgaWYgKHRva2VuKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgICAgYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICAgIFVQREFURSBhZG1pbl9zZXNzaW9ucyBcclxuICAgICAgICBTRVQgbG9nb3V0X3RpbWUgPSBOT1coKSBcclxuICAgICAgICBXSEVSRSBhZG1pbl9pZCA9ID8gQU5EIGxvZ291dF90aW1lIElTIE5VTEwgXHJcbiAgICAgICAgT1JERVIgQlkgbG9naW5fdGltZSBERVNDIExJTUlUIDFcclxuICAgICAgYCwgW2RlY29kZWQudXNlcklkXSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgbG9nb3V0OicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcbiAgcmVzLnNldEhlYWRlcignU2V0LUNvb2tpZScsICd0b2tlbj07IFBhdGg9LzsgRXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVDsgSHR0cE9ubHknKTtcclxuICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdMb2dvdXQgc3VjY2Vzc2Z1bCcgfSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldEFkbWluRGF0YShyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIGZ1bGxfbmFtZSwgdXNlcm5hbWUsIHBhc3N3b3JkLCBwaW4sIHJvbGUgRlJPTSBhZG1pbiBMSU1JVCAxJyk7XHJcbiAgICBpZiAocmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IGFkbWluRGF0YSA9IHJlc3VsdHNbMF07XHJcbiAgICAgIGFkbWluRGF0YS5wYXNzd29yZCA9ICcqJy5yZXBlYXQoYWRtaW5EYXRhLnBhc3N3b3JkLmxlbmd0aCk7XHJcbiAgICAgIGFkbWluRGF0YS5waW4gPSAnKicucmVwZWF0KGFkbWluRGF0YS5waW4ubGVuZ3RoKTtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oYWRtaW5EYXRhKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBZG1pbiBub3QgZm91bmQnIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBhZG1pbiBkYXRhOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBhZG1pbiBkYXRhJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUFkbWluRGF0YShyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgZnVsbF9uYW1lLCB1c2VybmFtZSwgcGFzc3dvcmQsIHBpbiwgcm9sZSB9ID0gcmVxLmJvZHk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGxldCBzcWwgPSAnVVBEQVRFIGFkbWluIFNFVCBmdWxsX25hbWUgPSA/LCB1c2VybmFtZSA9ID8sIHJvbGUgPSA/JztcclxuICAgIGxldCBwYXJhbXMgPSBbZnVsbF9uYW1lLCB1c2VybmFtZSwgcm9sZV07XHJcblxyXG4gICAgaWYgKHBhc3N3b3JkKSB7XHJcbiAgICAgIHNxbCArPSAnLCBwYXNzd29yZCA9ID8nO1xyXG4gICAgICBwYXJhbXMucHVzaChwYXNzd29yZCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBpbikge1xyXG4gICAgICBzcWwgKz0gJywgcGluID0gPyc7XHJcbiAgICAgIHBhcmFtcy5wdXNoKHBpbik7XHJcbiAgICB9XHJcblxyXG4gICAgc3FsICs9ICcgV0hFUkUgaWQgPSAxJzsgXHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoc3FsLCBwYXJhbXMpO1xyXG5cclxuICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdBZG1pbiBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnQWRtaW4gZGF0YSB1cGRhdGVkIHN1Y2Nlc3NmdWxseScgfSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGFkbWluIGRhdGE6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHVwZGF0aW5nIGFkbWluIGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0U2Vzc2lvbkhpc3RvcnkocmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdHNdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgXHJcbiAgICAgICAgcy5pZCwgXHJcbiAgICAgICAgYS5mdWxsX25hbWUsIFxyXG4gICAgICAgIGEudXNlcm5hbWUsIFxyXG4gICAgICAgIHMubG9naW5fdGltZSwgXHJcbiAgICAgICAgcy5sb2dvdXRfdGltZVxyXG4gICAgICBGUk9NIFxyXG4gICAgICAgIGFkbWluX3Nlc3Npb25zIHNcclxuICAgICAgSk9JTiBcclxuICAgICAgICBhZG1pbiBhIE9OIHMuYWRtaW5faWQgPSBhLmlkXHJcbiAgICAgIE9SREVSIEJZIFxyXG4gICAgICAgIHMubG9naW5fdGltZSBERVNDIFxyXG4gICAgICBMSU1JVCA1MFxyXG4gICAgYCk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHRzKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2Vzc2lvbiBoaXN0b3J5OicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBzZXNzaW9uIGhpc3RvcnknIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4vL1Byb2R1Y3RzXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFByb2R1Y3RzKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBwYWdlID0gMSwgbGltaXQgPSAxMCwgaWQsIGNhdGVnb3J5IH0gPSByZXEucXVlcnk7XHJcbiAgY29uc3Qgb2Zmc2V0ID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xyXG5cclxuICB0cnkge1xyXG4gICAgLy8gU2luZ2xlIHByb2R1Y3QgZmV0Y2hcclxuICAgIGlmIChpZCkge1xyXG4gICAgICBjb25zdCBbcHJvZHVjdHNdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICAgIFNFTEVDVCBcclxuICAgICAgICAgIHAuKixcclxuICAgICAgICAgIENPQUxFU0NFKHBzLnF1YW50aXR5LCAwKSBhcyBjdXJyZW50X3N0b2NrLFxyXG4gICAgICAgICAgQ0FTRSBXSEVOIENPQUxFU0NFKHBzLnF1YW50aXR5LCAwKSA8IDEwIFRIRU4gVFJVRSBFTFNFIEZBTFNFIEVORCBhcyBuZWVkc19yZXN0b2NrXHJcbiAgICAgICAgRlJPTSBwcm9kdWN0cyBwXHJcbiAgICAgICAgTEVGVCBKT0lOIHByb2R1Y3Rfc3RvY2tzIHBzIE9OIHAuaWQgPSBwcy5wcm9kdWN0X2lkXHJcbiAgICAgICAgV0hFUkUgcC5pZCA9ID8gQU5EIHAuZGVsZXRlZCA9IEZBTFNFYCxcclxuICAgICAgICBbcGFyc2VJbnQoaWQpXVxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKHByb2R1Y3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnUHJvZHVjdCBub3QgZm91bmQnIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgIHByb2R1Y3Q6IHByb2R1Y3RzWzBdLFxyXG4gICAgICAgIGN1cnJlbnRQYWdlOiAxLFxyXG4gICAgICAgIHRvdGFsUGFnZXM6IDEsXHJcbiAgICAgICAgdG90YWxJdGVtczogMVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDb3VudCB0b3RhbCBwcm9kdWN0c1xyXG4gICAgbGV0IGNvdW50UXVlcnkgPSAnU0VMRUNUIENPVU5UKCopIGFzIHRvdGFsIEZST00gcHJvZHVjdHMgV0hFUkUgZGVsZXRlZCA9IEZBTFNFJztcclxuICAgIGxldCBwYXJhbXMgPSBbXTtcclxuXHJcbiAgICBpZiAoY2F0ZWdvcnkpIHtcclxuICAgICAgY291bnRRdWVyeSArPSAnIEFORCBjYXRlZ29yeSA9ID8nO1xyXG4gICAgICBwYXJhbXMucHVzaChjYXRlZ29yeSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgW2NvdW50UmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGNvdW50UXVlcnksIHBhcmFtcyk7XHJcbiAgICBjb25zdCB0b3RhbEl0ZW1zID0gY291bnRSZXN1bHRbMF0udG90YWw7XHJcbiAgICBjb25zdCB0b3RhbFBhZ2VzID0gTWF0aC5jZWlsKHRvdGFsSXRlbXMgLyBsaW1pdCk7XHJcblxyXG4gICAgLy8gR2V0IHBhZ2luYXRlZCBwcm9kdWN0cyB3aXRoIHN0b2NrIGluZm9cclxuICAgIGxldCBwcm9kdWN0UXVlcnkgPSBgXHJcbiAgICAgIFNFTEVDVCBcclxuICAgICAgICBwLiosXHJcbiAgICAgICAgQ09BTEVTQ0UocHMucXVhbnRpdHksIDApIGFzIGN1cnJlbnRfc3RvY2ssXHJcbiAgICAgICAgQ0FTRSBXSEVOIENPQUxFU0NFKHBzLnF1YW50aXR5LCAwKSA8IDEwIFRIRU4gVFJVRSBFTFNFIEZBTFNFIEVORCBhcyBuZWVkc19yZXN0b2NrLFxyXG4gICAgICAgIChTRUxFQ1QgQ09VTlQoKikgRlJPTSBwcm9kdWN0X3N0b2NrcyBXSEVSRSBwcm9kdWN0X2lkID0gcC5pZCkgYXMgc3RvY2tfdXBkYXRlc1xyXG4gICAgICBGUk9NIHByb2R1Y3RzIHBcclxuICAgICAgTEVGVCBKT0lOIHByb2R1Y3Rfc3RvY2tzIHBzIE9OIHAuaWQgPSBwcy5wcm9kdWN0X2lkXHJcbiAgICAgIFdIRVJFIHAuZGVsZXRlZCA9IEZBTFNFXHJcbiAgICBgO1xyXG5cclxuICAgIGlmIChjYXRlZ29yeSkge1xyXG4gICAgICBwcm9kdWN0UXVlcnkgKz0gJyBBTkQgcC5jYXRlZ29yeSA9ID8nO1xyXG4gICAgICBwYXJhbXMgPSBbY2F0ZWdvcnldO1xyXG4gICAgfVxyXG5cclxuICAgIHByb2R1Y3RRdWVyeSArPSAnIE9SREVSIEJZIHAuaWQgQVNDIExJTUlUID8gT0ZGU0VUID8nO1xyXG4gICAgcGFyYW1zLnB1c2gocGFyc2VJbnQobGltaXQpLCBvZmZzZXQpO1xyXG5cclxuICAgIGNvbnN0IFtwcm9kdWN0c10gPSBhd2FpdCBkYi5xdWVyeShwcm9kdWN0UXVlcnksIHBhcmFtcyk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFsIHN0b2NrIHZhbHVlXHJcbiAgICBjb25zdCBbc3RvY2tWYWx1ZV0gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICAgIFNFTEVDVCBDT0FMRVNDRShTVU0ocC5wcmljZSAqIHBzLnF1YW50aXR5KSwgMCkgYXMgdG90YWxfdmFsdWVcclxuICAgICAgRlJPTSBwcm9kdWN0cyBwIFxyXG4gICAgICBMRUZUIEpPSU4gcHJvZHVjdF9zdG9ja3MgcHMgT04gcC5pZCA9IHBzLnByb2R1Y3RfaWRcclxuICAgICAgV0hFUkUgcC5kZWxldGVkID0gRkFMU0VcclxuICAgIGApO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgcHJvZHVjdHMsXHJcbiAgICAgIGN1cnJlbnRQYWdlOiBwYXJzZUludChwYWdlKSxcclxuICAgICAgdG90YWxQYWdlcyxcclxuICAgICAgdG90YWxJdGVtcyxcclxuICAgICAgdG90YWxTdG9ja1ZhbHVlOiBzdG9ja1ZhbHVlWzBdLnRvdGFsX3ZhbHVlXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdHM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGZldGNoaW5nIHByb2R1Y3RzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFRvdGFsU3RvY2socmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIFNVTShzdG9ja19xdWFudGl0eSkgYXMgdG90YWxTdG9jayBGUk9NIHByb2R1Y3RzJyk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHRvdGFsU3RvY2s6IHJlc3VsdFswXS50b3RhbFN0b2NrIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB0b3RhbCBzdG9jazonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgdG90YWwgc3RvY2snIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUFkZFByb2R1Y3QocmVxLCByZXMpIHtcclxuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCBwcmljZSwgaW1hZ2VfdXJsLCBjYXRlZ29yeSwgc3VwcGxpZXJfaWQgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnN0IHNxbCA9IFwiSU5TRVJUIElOVE8gcHJvZHVjdHMgKG5hbWUsIGRlc2NyaXB0aW9uLCBwcmljZSwgaW1hZ2VfdXJsLCBjYXRlZ29yeSwgc3VwcGxpZXJfaWQsIHN0b2NrX3F1YW50aXR5KSBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8pXCI7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIC8vIFNldCBpbml0aWFsIHN0b2NrX3F1YW50aXR5IHRvIDAgaW4gcHJvZHVjdHMgdGFibGVcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoc3FsLCBbbmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBpbWFnZV91cmwsIGNhdGVnb3J5LCBzdXBwbGllcl9pZCwgMF0pO1xyXG4gICAgXHJcbiAgICAvLyBSZW1vdmUgdGhlIGF1dG9tYXRpYyBzdG9jayBlbnRyeSBjcmVhdGlvblxyXG4gICAgLy8gTm93IHN0b2NrcyB3aWxsIG9ubHkgYmUgYWRkZWQgdGhyb3VnaCB0aGUgU3RvY2tzIE1hbmFnZW1lbnQgaW50ZXJmYWNlXHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDEpLmpzb24oeyBcclxuICAgICAgbWVzc2FnZTogJ1Byb2R1Y3QgYWRkZWQgc3VjY2Vzc2Z1bGx5JywgXHJcbiAgICAgIGlkOiByZXN1bHQuaW5zZXJ0SWQgXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgYWRkaW5nIHByb2R1Y3Q6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGFkZGluZyBwcm9kdWN0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZVByb2R1Y3QocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGltYWdlX3VybCwgc3RvY2tfcXVhbnRpdHksIGNhdGVnb3J5LCBzdXBwbGllcl9pZCB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgcHJvZHVjdHMgU0VUIG5hbWU9PywgZGVzY3JpcHRpb249PywgcHJpY2U9PywgaW1hZ2VfdXJsPT8sIHN0b2NrX3F1YW50aXR5PT8sIGNhdGVnb3J5PT8sIHN1cHBsaWVyX2lkPT8gV0hFUkUgaWQ9P1wiO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW25hbWUsIGRlc2NyaXB0aW9uLCBwcmljZSwgaW1hZ2VfdXJsLCBzdG9ja19xdWFudGl0eSwgY2F0ZWdvcnksIHN1cHBsaWVyX2lkLCBpZF0pO1xyXG4gICAgaWYgKHJlc3VsdC5hZmZlY3RlZFJvd3MgPT09IDApIHtcclxuICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ1Byb2R1Y3QgdXBkYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciB1cGRhdGluZyBwcm9kdWN0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZVByb2R1Y3QocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgcHJvZHVjdHMgU0VUIGRlbGV0ZWQgPSBUUlVFIFdIRVJFIGlkID0gP1wiO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW2lkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnUHJvZHVjdCBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnUHJvZHVjdCBtYXJrZWQgYXMgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIHByb2R1Y3QgYXMgZGVsZXRlZDonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgbWFya2luZyBwcm9kdWN0IGFzIGRlbGV0ZWQnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy8gU3RvY2tzXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFN0b2NrcyhyZXEsIHJlcykge1xyXG4gIGNvbnN0IHBhZ2UgPSBwYXJzZUludChyZXEucXVlcnkucGFnZSkgfHwgMTtcclxuICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KHJlcS5xdWVyeS5saW1pdCkgfHwgMTA7XHJcbiAgY29uc3Qgb2Zmc2V0ID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3N0b2Nrc10gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICAgIFNFTEVDVCBcclxuICAgICAgICBwcy5pZCxcclxuICAgICAgICBwcy5wcm9kdWN0X2lkLFxyXG4gICAgICAgIHAubmFtZSxcclxuICAgICAgICBwcy5xdWFudGl0eSxcclxuICAgICAgICBwcy5sYXN0X3VwZGF0ZWQsXHJcbiAgICAgICAgQ0FTRSBXSEVOIHBzLnF1YW50aXR5IDwgMTAgVEhFTiBUUlVFIEVMU0UgRkFMU0UgRU5EIGFzIGxvd19zdG9ja1xyXG4gICAgICBGUk9NIHByb2R1Y3Rfc3RvY2tzIHBzXHJcbiAgICAgIEpPSU4gcHJvZHVjdHMgcCBPTiBwcy5wcm9kdWN0X2lkID0gcC5pZFxyXG4gICAgICBXSEVSRSBwLmRlbGV0ZWQgPSBGQUxTRVxyXG4gICAgICBPUkRFUiBCWSBwcy5sYXN0X3VwZGF0ZWQgREVTQ1xyXG4gICAgICBMSU1JVCA/IE9GRlNFVCA/YCxcclxuICAgICAgW2xpbWl0LCBvZmZzZXRdXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IFtjb3VudFJlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShcclxuICAgICAgJ1NFTEVDVCBDT1VOVCgqKSBhcyB0b3RhbCBGUk9NIHByb2R1Y3Rfc3RvY2tzIHBzIEpPSU4gcHJvZHVjdHMgcCBPTiBwcy5wcm9kdWN0X2lkID0gcC5pZCBXSEVSRSBwLmRlbGV0ZWQgPSBGQUxTRSdcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgdG90YWxJdGVtcyA9IGNvdW50UmVzdWx0WzBdLnRvdGFsO1xyXG4gICAgY29uc3QgdG90YWxQYWdlcyA9IE1hdGguY2VpbCh0b3RhbEl0ZW1zIC8gbGltaXQpO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgc3RvY2tzLFxyXG4gICAgICBjdXJyZW50UGFnZTogcGFnZSxcclxuICAgICAgdG90YWxQYWdlcyxcclxuICAgICAgdG90YWxJdGVtc1xyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHN0b2NrczonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgc3RvY2tzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUFkZFN0b2NrKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBpZCwgcHJvZHVjdF9pZCwgcXVhbnRpdHkgfSA9IHJlcS5ib2R5O1xyXG4gIFxyXG4gIGlmICghcHJvZHVjdF9pZCB8fCAhcXVhbnRpdHkgfHwgIWlkKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1N0b2NrIElELCBQcm9kdWN0IElEIGFuZCBxdWFudGl0eSBhcmUgcmVxdWlyZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IGRiLnF1ZXJ5KCdTVEFSVCBUUkFOU0FDVElPTicpO1xyXG5cclxuICAgIC8vIENoZWNrIGlmIHByb2R1Y3QgZXhpc3RzXHJcbiAgICBjb25zdCBbcHJvZHVjdF0gPSBhd2FpdCBkYi5xdWVyeShcclxuICAgICAgJ1NFTEVDVCBpZCBGUk9NIHByb2R1Y3RzIFdIRVJFIGlkID0gPyBBTkQgZGVsZXRlZCA9IEZBTFNFJyxcclxuICAgICAgW3Byb2R1Y3RfaWRdXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChwcm9kdWN0Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBhd2FpdCBkYi5xdWVyeSgnUk9MTEJBQ0snKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdQcm9kdWN0IG5vdCBmb3VuZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgc3RvY2sgZW50cnkgZXhpc3RzXHJcbiAgICBjb25zdCBbZXhpc3RpbmdTdG9ja10gPSBhd2FpdCBkYi5xdWVyeShcclxuICAgICAgJ1NFTEVDVCAqIEZST00gcHJvZHVjdF9zdG9ja3MgV0hFUkUgaWQgPSA/IE9SIHByb2R1Y3RfaWQgPSA/JyxcclxuICAgICAgW2lkLCBwcm9kdWN0X2lkXVxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAoZXhpc3RpbmdTdG9jay5sZW5ndGggPiAwKSB7XHJcbiAgICAgIC8vIENoZWNrIGZvciBjb25mbGljdHNcclxuICAgICAgY29uc3Qgc3RvY2tFbnRyeSA9IGV4aXN0aW5nU3RvY2tbMF07XHJcbiAgICAgIFxyXG4gICAgICAvLyBDYXNlIDE6IFVzaW5nIGV4aXN0aW5nIHN0b2NrIElEIHdpdGggZGlmZmVyZW50IHByb2R1Y3RcclxuICAgICAgaWYgKHN0b2NrRW50cnkuaWQgPT09IHBhcnNlSW50KGlkKSAmJiBzdG9ja0VudHJ5LnByb2R1Y3RfaWQgIT09IHBhcnNlSW50KHByb2R1Y3RfaWQpKSB7XHJcbiAgICAgICAgYXdhaXQgZGIucXVlcnkoJ1JPTExCQUNLJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXHJcbiAgICAgICAgICBlcnJvcjogYFN0b2NrIElEICR7aWR9IGlzIGFscmVhZHkgYXNzaWduZWQgdG8gUHJvZHVjdCBJRCAke3N0b2NrRW50cnkucHJvZHVjdF9pZH1gIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDYXNlIDI6IFByb2R1Y3QgaGFzIGRpZmZlcmVudCBzdG9jayBJRFxyXG4gICAgICBpZiAoc3RvY2tFbnRyeS5wcm9kdWN0X2lkID09PSBwYXJzZUludChwcm9kdWN0X2lkKSAmJiBzdG9ja0VudHJ5LmlkICE9PSBwYXJzZUludChpZCkpIHtcclxuICAgICAgICBhd2FpdCBkYi5xdWVyeSgnUk9MTEJBQ0snKTtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcclxuICAgICAgICAgIGVycm9yOiBgUHJvZHVjdCBJRCAke3Byb2R1Y3RfaWR9IGFscmVhZHkgaGFzIFN0b2NrIElEICR7c3RvY2tFbnRyeS5pZH1gIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDYXNlIDM6IFZhbGlkIHVwZGF0ZSAtIGFkZCBuZXcgcXVhbnRpdHkgdG8gZXhpc3RpbmdcclxuICAgICAgY29uc3QgbmV3UXVhbnRpdHkgPSBzdG9ja0VudHJ5LnF1YW50aXR5ICsgcGFyc2VJbnQocXVhbnRpdHkpO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgZGIucXVlcnkoXHJcbiAgICAgICAgYFVQREFURSBwcm9kdWN0X3N0b2NrcyBcclxuICAgICAgICAgU0VUIHF1YW50aXR5ID0gPywgbGFzdF91cGRhdGVkID0gTk9XKCkgXHJcbiAgICAgICAgIFdIRVJFIGlkID0gPyBBTkQgcHJvZHVjdF9pZCA9ID9gLFxyXG4gICAgICAgIFtuZXdRdWFudGl0eSwgaWQsIHByb2R1Y3RfaWRdXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBhd2FpdCBkYi5xdWVyeSgnQ09NTUlUJyk7XHJcblxyXG4gICAgICAvLyBGZXRjaCB0aGUgdXBkYXRlZCBzdG9jayB0byBjb25maXJtXHJcbiAgICAgIGNvbnN0IFt1cGRhdGVkU3RvY2tdID0gYXdhaXQgZGIucXVlcnkoXHJcbiAgICAgICAgJ1NFTEVDVCAqIEZST00gcHJvZHVjdF9zdG9ja3MgV0hFUkUgaWQgPSA/JyxcclxuICAgICAgICBbaWRdXHJcbiAgICAgICk7XHJcblxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxyXG4gICAgICAgIG1lc3NhZ2U6ICdTdG9jayB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsXHJcbiAgICAgICAgaWQsXHJcbiAgICAgICAgcHJvZHVjdF9pZCxcclxuICAgICAgICBwcmV2aW91c1F1YW50aXR5OiBzdG9ja0VudHJ5LnF1YW50aXR5LFxyXG4gICAgICAgIGFkZGVkUXVhbnRpdHk6IHBhcnNlSW50KHF1YW50aXR5KSxcclxuICAgICAgICBuZXdRdWFudGl0eTogdXBkYXRlZFN0b2NrWzBdLnF1YW50aXR5LFxyXG4gICAgICAgIG5lZWRzUmVzdG9jazogdXBkYXRlZFN0b2NrWzBdLnF1YW50aXR5IDwgMTBcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBJbnNlcnQgbmV3IHN0b2NrIGVudHJ5XHJcbiAgICAgIGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgICAgICdJTlNFUlQgSU5UTyBwcm9kdWN0X3N0b2NrcyAoaWQsIHByb2R1Y3RfaWQsIHF1YW50aXR5LCBsYXN0X3VwZGF0ZWQpIFZBTFVFUyAoPywgPywgPywgTk9XKCkpJyxcclxuICAgICAgICBbaWQsIHByb2R1Y3RfaWQsIHF1YW50aXR5XVxyXG4gICAgICApO1xyXG5cclxuICAgICAgYXdhaXQgZGIucXVlcnkoJ0NPTU1JVCcpO1xyXG5cclxuICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24oeyBcclxuICAgICAgICBtZXNzYWdlOiAnU3RvY2sgYWRkZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgICAgICBpZCxcclxuICAgICAgICBwcm9kdWN0X2lkLFxyXG4gICAgICAgIHF1YW50aXR5OiBwYXJzZUludChxdWFudGl0eSksXHJcbiAgICAgICAgbmVlZHNSZXN0b2NrOiBwYXJzZUludChxdWFudGl0eSkgPCAxMFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgYXdhaXQgZGIucXVlcnkoJ1JPTExCQUNLJyk7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYW5hZ2luZyBzdG9jazonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgbWFuYWdpbmcgc3RvY2s6ICcgKyBlcnJvci5tZXNzYWdlIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlU3RvY2socmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3QgeyBxdWFudGl0eSB9ID0gcmVxLmJvZHk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIC8vIEZpcnN0LCBnZXQgdGhlIGN1cnJlbnQgc3RvY2tcclxuICAgIGNvbnN0IFtleGlzdGluZ1N0b2NrXSA9IGF3YWl0IGRiLnF1ZXJ5KFxyXG4gICAgICAnU0VMRUNUICogRlJPTSBwcm9kdWN0X3N0b2NrcyBXSEVSRSBpZCA9ID8nLFxyXG4gICAgICBbaWRdXHJcbiAgICApO1xyXG5cclxuICAgIGlmIChleGlzdGluZ1N0b2NrLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1N0b2NrIGVudHJ5IG5vdCBmb3VuZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHRoZSBuZXcgcXVhbnRpdHkgKGN1cnJlbnQgKyBhZGRlZClcclxuICAgIGNvbnN0IG5ld1F1YW50aXR5ID0gcXVhbnRpdHk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHRoZSBzdG9jayBxdWFudGl0eVxyXG4gICAgY29uc3Qgc3FsID0gYFxyXG4gICAgICBVUERBVEUgcHJvZHVjdF9zdG9ja3MgXHJcbiAgICAgIFNFVCBxdWFudGl0eSA9ID8sXHJcbiAgICAgICAgICBsYXN0X3VwZGF0ZWQgPSBOT1coKVxyXG4gICAgICBXSEVSRSBpZCA9ID9cclxuICAgIGA7XHJcbiAgICBcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoc3FsLCBbbmV3UXVhbnRpdHksIGlkXSk7XHJcblxyXG4gICAgLy8gQWxzbyB1cGRhdGUgdGhlIHN0b2NrX3F1YW50aXR5IGluIHByb2R1Y3RzIHRhYmxlXHJcbiAgICBhd2FpdCBkYi5xdWVyeShcclxuICAgICAgJ1VQREFURSBwcm9kdWN0cyBTRVQgc3RvY2tfcXVhbnRpdHkgPSA/IFdIRVJFIGlkID0gPycsXHJcbiAgICAgIFtuZXdRdWFudGl0eSwgZXhpc3RpbmdTdG9ja1swXS5wcm9kdWN0X2lkXVxyXG4gICAgKTtcclxuXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IFxyXG4gICAgICBtZXNzYWdlOiAnU3RvY2sgdXBkYXRlZCBzdWNjZXNzZnVsbHknLFxyXG4gICAgICB1cGRhdGVkU3RvY2s6IHtcclxuICAgICAgICBpZCxcclxuICAgICAgICBxdWFudGl0eTogbmV3UXVhbnRpdHksXHJcbiAgICAgICAgbGFzdF91cGRhdGVkOiBuZXcgRGF0ZSgpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBzdG9jazonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgdXBkYXRpbmcgc3RvY2snIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3RvY2socmVxLCByZXMsIGlkKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEZpcnN0IGdldCB0aGUgc3RvY2sgdG8gdXBkYXRlIHByb2R1Y3QgcXVhbnRpdHlcclxuICAgIGNvbnN0IFtzdG9ja10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUICogRlJPTSBwcm9kdWN0X3N0b2NrcyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcclxuICAgIFxyXG4gICAgaWYgKHN0b2NrLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1N0b2NrIG5vdCBmb3VuZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRGVsZXRlIHRoZSBzdG9jayByZWNvcmRcclxuICAgIGF3YWl0IGRiLnF1ZXJ5KCdERUxFVEUgRlJPTSBwcm9kdWN0X3N0b2NrcyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHByb2R1Y3QncyBzdG9ja19xdWFudGl0eVxyXG4gICAgYXdhaXQgZGIucXVlcnkoXHJcbiAgICAgICdVUERBVEUgcHJvZHVjdHMgU0VUIHN0b2NrX3F1YW50aXR5ID0gc3RvY2tfcXVhbnRpdHkgLSA/IFdIRVJFIGlkID0gPycsXHJcbiAgICAgIFtzdG9ja1swXS5xdWFudGl0eSwgc3RvY2tbMF0ucHJvZHVjdF9pZF1cclxuICAgICk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnU3RvY2sgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBzdG9jazonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZGVsZXRpbmcgc3RvY2snIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy9PcmRlciBNb25pdG9yaW5nXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFNhbGVzUmVwb3J0KHJlcSwgcmVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgXHJcbiAgICAgICAgby4qLFxyXG4gICAgICAgIEdST1VQX0NPTkNBVChDT05DQVQob3AubmFtZSwgJyAoJywgb3AucXVhbnRpdHksICcpJykgU0VQQVJBVE9SICcsICcpIEFTIG9yZGVyZWRfcHJvZHVjdHNcclxuICAgICAgRlJPTSBvcmRlcnMgb1xyXG4gICAgICBMRUZUIEpPSU4gb3JkZXJlZF9wcm9kdWN0cyBvcCBPTiBvLmlkID0gb3Aub3JkZXJfaWRcclxuICAgICAgV0hFUkUgby5pbl9zYWxlc19yZXBvcnQgPSAxXHJcbiAgICAgIEdST1VQIEJZIG8uaWRcclxuICAgICAgT1JERVIgQlkgby5vcmRlcl9kYXRlIERFU0NcclxuICAgIGApO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FsZXMgcmVwb3J0OicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBzYWxlcyByZXBvcnQgZGF0YScgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVVcGRhdGVPcmRlclN0YXR1cyhyZXEsIHJlcywgaWQpIHtcclxuICBjb25zdCB7IHN0YXR1cyB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc29sZS5sb2coJ1VwZGF0aW5nIG9yZGVyIHN0YXR1czonLCBpZCwgc3RhdHVzKTtcclxuXHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgb3JkZXJzIFNFVCBzdGF0dXMgPSA/IFdIRVJFIGlkID0gP1wiO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW3N0YXR1cywgaWRdKTtcclxuICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdPcmRlciBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnT3JkZXIgc3RhdHVzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5Jywgc3RhdHVzOiBzdGF0dXMgfSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIG9yZGVyIHN0YXR1czonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgdXBkYXRpbmcgb3JkZXIgc3RhdHVzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNhbmNlbE9yZGVyKHJlcSwgcmVzLCBpZCkge1xyXG4gIGNvbnN0IHNxbCA9IFwiVVBEQVRFIG9yZGVycyBTRVQgc3RhdHVzID0gJ0NhbmNlbGxlZCcgV0hFUkUgaWQgPSA/XCI7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoc3FsLCBbaWRdKTtcclxuICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdPcmRlciBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnT3JkZXIgY2FuY2VsbGVkIHN1Y2Nlc3NmdWxseScgfSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbmNlbGxpbmcgb3JkZXI6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGNhbmNlbGxpbmcgb3JkZXInIH0pO1xyXG4gIH1cclxufVxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVVcGRhdGVPcmRlcihyZXEsIHJlcywgaWQpIHtcclxuICBjb25zdCB7IG9yZGVyX2RhdGUgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnN0IHNxbCA9IFwiVVBEQVRFIG9yZGVycyBTRVQgb3JkZXJfZGF0ZSA9ID8gV0hFUkUgaWQgPSA/XCI7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoc3FsLCBbb3JkZXJfZGF0ZSwgaWRdKTtcclxuICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdPcmRlciBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnT3JkZXIgZGF0ZSB1cGRhdGVkIHN1Y2Nlc3NmdWxseScgfSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIG9yZGVyIGRhdGU6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIHVwZGF0aW5nIG9yZGVyIGRhdGUnIH0pO1xyXG4gIH1cclxufVxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVSZW1vdmVPcmRlckZyb21TYWxlc1JlcG9ydChyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5xdWVyeTtcclxuICBjb25zdCBzcWwgPSBcIlVQREFURSBvcmRlcnMgU0VUIGluX3NhbGVzX3JlcG9ydCA9IDAgV0hFUkUgaWQgPSA/XCI7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoc3FsLCBbaWRdKTtcclxuICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdPcmRlciBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnT3JkZXIgcmVtb3ZlZCBmcm9tIHNhbGVzIHJlcG9ydCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyBvcmRlciBmcm9tIHNhbGVzIHJlcG9ydDonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgcmVtb3Zpbmcgb3JkZXIgZnJvbSBzYWxlcyByZXBvcnQnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0T3JkZXJzKHJlcSwgcmVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1Qgby4qLCBcclxuICAgICAgICAgICAgIEdST1VQX0NPTkNBVChcclxuICAgICAgICAgICAgICAgQ09OQ0FUKFxyXG4gICAgICAgICAgICAgICAgIG9wLm5hbWUsIFxyXG4gICAgICAgICAgICAgICAgICcgKCcsIG9wLnF1YW50aXR5LCAnKScsXHJcbiAgICAgICAgICAgICAgICAgJyBbJywgSUZOVUxMKHAuaW1hZ2VfdXJsLCAnJyksICddJ1xyXG4gICAgICAgICAgICAgICApIFxyXG4gICAgICAgICAgICAgICBTRVBBUkFUT1IgJywgJ1xyXG4gICAgICAgICAgICAgKSBBUyBvcmRlcmVkX3Byb2R1Y3RzXHJcbiAgICAgIEZST00gb3JkZXJzIG9cclxuICAgICAgTEVGVCBKT0lOIG9yZGVyZWRfcHJvZHVjdHMgb3AgT04gby5pZCA9IG9wLm9yZGVyX2lkXHJcbiAgICAgIExFRlQgSk9JTiBwcm9kdWN0cyBwIE9OIG9wLnByb2R1Y3RfaWQgPSBwLmlkXHJcbiAgICAgIFdIRVJFIG8uaW5fc2FsZXNfcmVwb3J0ID0gMVxyXG4gICAgICBHUk9VUCBCWSBvLmlkXHJcbiAgICBgKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9yZGVyczonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgb3JkZXJzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IGhhbmRsZVVwZGF0ZUFkbWluRGF0YSB9OyJdLCJuYW1lcyI6WyJteXNxbCIsInBhcnNlIiwic2lnbiIsInZlcmlmeSIsInF1ZXJ5IiwiZGIiLCJjcmVhdGVQb29sIiwiaG9zdCIsInByb2Nlc3MiLCJlbnYiLCJNWVNRTF9IT1NUIiwicG9ydCIsIk1ZU1FMX1BPUlQiLCJ1c2VyIiwiTVlTUUxfVVNFUiIsInBhc3N3b3JkIiwiTVlTUUxfUEFTU1dPUkQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwid2FpdEZvckNvbm5lY3Rpb25zIiwiY29ubmVjdGlvbkxpbWl0IiwicXVldWVMaW1pdCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJwYXRobmFtZSIsInVybCIsImNvbnNvbGUiLCJsb2ciLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsInJlc3VsdHMiLCJsZW5ndGgiLCJmdWxsTmFtZSIsImZ1bGxfbmFtZSIsImVycm9yIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlcm5hbWVQYXNzd29yZFZlcmlmaWVkIiwidG9rZW4iLCJzcGxpdCIsImRlY29kZWQiLCJKV1RfU0VDUkVUIiwibm93IiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsImV4cCIsImV4cGlyZXNJbiIsImhhbmRsZUdldFByb2R1Y3RzIiwiaGFuZGxlR2V0U3RvY2tzIiwiaGFuZGxlR2V0VG90YWxTdG9jayIsImhhbmRsZUdldFNhbGVzUmVwb3J0IiwiaGFuZGxlR2V0U2FsZXNEYXRhIiwiaGFuZGxlR2V0VG90YWxQcm9kdWN0cyIsImhhbmRsZUdldFRvcFByb2R1Y3RzIiwiaGFuZGxlR2V0UmF0ZWRQcm9kdWN0c0NvdW50IiwiaGFuZGxlTG9nb3V0IiwiaGFuZGxlR2V0T3JkZXJzIiwiaGFuZGxlR2V0QWRtaW5EYXRhIiwiaGFuZGxlR2V0U2Vzc2lvbkhpc3RvcnkiLCJoYW5kbGVHZXRQcm9kdWN0QW5hbHl0aWNzIiwiaGFuZGxlR2V0UHJvZHVjdFBlcmZvcm1hbmNlIiwiaGFuZGxlR2V0RGFpbHlTYWxlcyIsImhhbmRsZUdldFdlZWtseVNhbGVzIiwiaGFuZGxlR2V0TW9udGhseVNhbGVzIiwiaGFuZGxlR2V0WWVhcmx5U2FsZXMiLCJoYW5kbGVHZXRPcmRlckRldGFpbHMiLCJoYW5kbGVTaWduSW4iLCJoYW5kbGVWYWxpZGF0ZVBpbiIsImhhbmRsZUFkZFByb2R1Y3QiLCJoYW5kbGVBZGRTdG9jayIsInN0YXJ0c1dpdGgiLCJpZCIsInBvcCIsImhhbmRsZVVwZGF0ZVByb2R1Y3QiLCJoYW5kbGVVcGRhdGVTdG9jayIsInBhcnRzIiwiaGFuZGxlVXBkYXRlT3JkZXJTdGF0dXMiLCJoYW5kbGVDYW5jZWxPcmRlciIsImhhbmRsZVVwZGF0ZU9yZGVyIiwiaGFuZGxlVXBkYXRlQWRtaW5EYXRhIiwiaGFuZGxlRGVsZXRlUHJvZHVjdCIsImhhbmRsZURlbGV0ZVN0b2NrIiwiZW5kc1dpdGgiLCJoYW5kbGVSZW1vdmVPcmRlckZyb21TYWxlc1JlcG9ydCIsInNldEhlYWRlciIsImVuZCIsImRhdGUiLCJkYXRlQ29uZGl0aW9uIiwicXVlcnlEYXRlIiwidG9JU09TdHJpbmciLCJ5ZWFyIiwiY3VycmVudFllYXIiLCJnZXRGdWxsWWVhciIsImZvcm1hdHRlZFJlc3VsdHMiLCJtYXAiLCJyb3ciLCJtb250aCIsIm9yZGVyQ291bnQiLCJOdW1iZXIiLCJ0b3RhbCIsImNhbmNlbGxlZENvdW50IiwiY2FuY2VsbGVkVG90YWwiLCJkYXlzT2ZXZWVrIiwiZnVsbFdlZWtEYXRhIiwiQXJyYXkiLCJmcm9tIiwiXyIsImkiLCJwZXJpb2QiLCJvcmRlcnMiLCJjYW5jZWxsZWRPcmRlcnMiLCJmb3JFYWNoIiwiZGF5SW5kZXgiLCJ3ZWVrTnVtYmVyIiwid2Vla1N0YXJ0IiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwid2Vla0VuZCIsInllYXJseURhdGEiLCJpbmRleCIsInRvU3RyaW5nIiwieWVhckluZGV4Iiwic2FsZXNSZXN1bHQiLCJvcmRlcnNSZXN1bHQiLCJjdXN0b21lcnNSZXN1bHQiLCJyZXN1bHQiLCJwZXJpb2RTYWxlcyIsInRvdGFsT3JkZXJzIiwidG90YWxDdXN0b21lcnMiLCJmb3JtYXR0ZWRSZXN1bHQiLCJwcm9kdWN0IiwiYXZnX3JhdGluZyIsInRvRml4ZWQiLCJ0aW1lRnJhbWUiLCJwcm9kdWN0cyIsImFuYWx5emVkUHJvZHVjdHMiLCJpc1NhbGVhYmxlIiwib3JkZXJfY291bnQiLCJzdG9ja19xdWFudGl0eSIsInNhbGVhYmxlUHJvZHVjdHMiLCJmaWx0ZXIiLCJwIiwibm9uU2FsZWFibGVQcm9kdWN0cyIsInRvdGFsUHJvZHVjdHMiLCJzYWxlYWJsZUNvdW50Iiwibm9uU2FsZWFibGVDb3VudCIsInBlcmZvcm1hbmNlRGF0YSIsInRvdGFsX3VuaXRzX3NvbGQiLCJwZXJmb3JtYW5jZSIsInNsaWNlIiwidXNlcm5hbWUiLCJib2R5IiwicGFzc3dvcmRNYXRjaCIsInVzZXJJZCIsInN1Y2Nlc3MiLCJwaW4iLCJzdG9yZWRQaW4iLCJTdHJpbmciLCJhZG1pbkRhdGEiLCJyZXBlYXQiLCJyb2xlIiwic3FsIiwicGFyYW1zIiwicHVzaCIsImFmZmVjdGVkUm93cyIsInBhZ2UiLCJsaW1pdCIsImNhdGVnb3J5Iiwib2Zmc2V0IiwicGFyc2VJbnQiLCJjdXJyZW50UGFnZSIsInRvdGFsUGFnZXMiLCJ0b3RhbEl0ZW1zIiwiY291bnRRdWVyeSIsImNvdW50UmVzdWx0IiwiY2VpbCIsInByb2R1Y3RRdWVyeSIsInN0b2NrVmFsdWUiLCJ0b3RhbFN0b2NrVmFsdWUiLCJ0b3RhbF92YWx1ZSIsInRvdGFsU3RvY2siLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJwcmljZSIsImltYWdlX3VybCIsInN1cHBsaWVyX2lkIiwiaW5zZXJ0SWQiLCJzdG9ja3MiLCJwcm9kdWN0X2lkIiwicXVhbnRpdHkiLCJleGlzdGluZ1N0b2NrIiwic3RvY2tFbnRyeSIsIm5ld1F1YW50aXR5IiwidXBkYXRlZFN0b2NrIiwicHJldmlvdXNRdWFudGl0eSIsImFkZGVkUXVhbnRpdHkiLCJuZWVkc1Jlc3RvY2siLCJsYXN0X3VwZGF0ZWQiLCJzdG9jayIsIm9yZGVyX2RhdGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/[...nextapi].js\n");

/***/ }),

/***/ "(api)/./src/utils/db.js":
/*!*************************!*\
  !*** ./src/utils/db.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: parseInt(process.env.MYSQL_PORT),\n    database: process.env.MYSQL_DATABASE,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    connectionLimit: 10,\n    waitForConnections: true,\n    queueLimit: 0\n});\nasync function query(sql, values) {\n    try {\n        const [results] = await pool.query(sql, values);\n        return results;\n    } catch (error) {\n        console.error(\"Database query error:\", error);\n        throw error;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvZGIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFtQztBQUVuQyxNQUFNQyxPQUFPRCxnRUFBZ0IsQ0FBQztJQUM1QkcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVO0lBQzVCQyxNQUFNQyxTQUFTSixRQUFRQyxHQUFHLENBQUNJLFVBQVU7SUFDckNDLFVBQVVOLFFBQVFDLEdBQUcsQ0FBQ00sY0FBYztJQUNwQ0MsTUFBTVIsUUFBUUMsR0FBRyxDQUFDUSxVQUFVO0lBQzVCQyxVQUFVVixRQUFRQyxHQUFHLENBQUNVLGNBQWM7SUFDcENDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxZQUFZO0FBQ2Q7QUFFTyxlQUFlQyxNQUFNQyxHQUFHLEVBQUVDLE1BQU07SUFDckMsSUFBSTtRQUNGLE1BQU0sQ0FBQ0MsUUFBUSxHQUFHLE1BQU1yQixLQUFLa0IsS0FBSyxDQUFDQyxLQUFLQztRQUN4QyxPQUFPQztJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxpRUFBZXRCLElBQUlBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbnBhbmVsLy4vc3JjL3V0aWxzL2RiLmpzP2QzODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcclxuXHJcbmNvbnN0IHBvb2wgPSBteXNxbC5jcmVhdGVQb29sKHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NULFxyXG4gIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52Lk1ZU1FMX1BPUlQpLFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcclxuICB1c2VyOiBwcm9jZXNzLmVudi5NWVNRTF9VU0VSLFxyXG4gIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5NWVNRTF9QQVNTV09SRCxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBxdWV1ZUxpbWl0OiAwXHJcbn0pO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5KHNxbCwgdmFsdWVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IHBvb2wucXVlcnkoc3FsLCB2YWx1ZXMpO1xyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcG9vbDsiXSwibmFtZXMiOlsibXlzcWwiLCJwb29sIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiTVlTUUxfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIk1ZU1FMX1BPUlQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiY29ubmVjdGlvbkxpbWl0Iiwid2FpdEZvckNvbm5lY3Rpb25zIiwicXVldWVMaW1pdCIsInF1ZXJ5Iiwic3FsIiwidmFsdWVzIiwicmVzdWx0cyIsImVycm9yIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/utils/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();